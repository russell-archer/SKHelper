{"sections":[],"hierarchy":{"paths":[["doc:\/\/SKHelper\/documentation\/SKHelper"]]},"schemaVersion":{"patch":0,"minor":3,"major":0},"metadata":{"images":[{"identifier":"skhelper-logo-small.png","type":"icon"}],"title":"SKHelper Guide","roleHeading":"Article","modules":[{"name":"SKHelper"}],"role":"article"},"abstract":[{"type":"text","text":"Updated: October 16, 2024 11:53 PM"}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/SKHelper\/documentation\/SKHelper\/guide"},"kind":"article","variants":[{"paths":["\/documentation\/skhelper\/guide"],"traits":[{"interfaceLanguage":"swift"}]}],"primaryContentSections":[{"content":[{"level":2,"type":"heading","text":"Contents","anchor":"Contents"},{"items":[{"content":[{"inlineContent":[{"type":"reference","isActive":true,"identifier":"#Overview"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"isActive":true,"type":"reference","identifier":"#What-is-StoreKit"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"isActive":true,"identifier":"#What-is-SKHelper","type":"reference"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"#Source-Code","type":"reference","isActive":true}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"#References","isActive":true}]}]},{"content":[{"inlineContent":[{"identifier":"#What-does-this-document-provide","isActive":true,"type":"reference"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"identifier":"#Do-I-really-need-SKHelper","isActive":true,"type":"reference"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"identifier":"#The-SKHelperDemo-App","type":"reference","isActive":true}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"identifier":"#What-are-we-building","type":"reference","isActive":true}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"#Prerequisites","isActive":true}]}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"#Get-Started","type":"reference","isActive":true}]}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"#Configuring-products","isActive":true,"type":"reference"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"isActive":true,"type":"reference","identifier":"#Localized-productâ€“information"}]}]},{"content":[{"inlineContent":[{"type":"reference","isActive":true,"identifier":"#The-Products.plist-file"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"isActive":true,"type":"reference","identifier":"#Product-types"}]}]},{"content":[{"inlineContent":[{"type":"reference","isActive":true,"identifier":"#The-StoreKit-Configuration-file"}],"type":"paragraph"}]}],"type":"unorderedList"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"#Why-do-we-have-two-product-lists","isActive":true}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","isActive":true,"identifier":"#Enable-StoreKitâ€“Testing"}]}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"#Configure-product-images","isActive":true}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"#Displaying-a-list-of-products","isActive":true}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"isActive":true,"identifier":"#Testing-non-U.S.-localizations","type":"reference"}],"type":"paragraph"}]}]}]},{"content":[{"inlineContent":[{"identifier":"#Customizing-the-appearance-of-the-product-list","type":"reference","isActive":true}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"#How-does-SKHelperStoreView-work","isActive":true}]}]}],"type":"unorderedList"}]}],"type":"unorderedList"},{"type":"thematicBreak"},{"anchor":"Overview","type":"heading","text":"Overview","level":2},{"inlineContent":[{"type":"text","text":"This guide describes how to implement and test in-app purchases with "},{"type":"strong","inlineContent":[{"type":"text","text":"SwiftUI"}]},{"type":"text","text":", "},{"code":"SKHelper","type":"codeVoice"},{"text":", ","type":"text"},{"type":"codeVoice","code":"StoreKit2"},{"text":", ","type":"text"},{"inlineContent":[{"text":"Xcode 16, iOS 17+","type":"text"}],"type":"strong"},{"type":"text","text":"Â andÂ "},{"inlineContent":[{"type":"text","text":"macOS 14.6+"}],"type":"strong"},{"text":".","type":"text"}],"type":"paragraph"},{"inlineContent":[{"identifier":"skhelper-logo.png","type":"image"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"We will cover similar ground to that discussed in the "},{"type":"reference","identifier":"https:\/\/russell-archer.github.io\/SKHelper\/tutorials\/quickstart","isActive":true},{"text":", although in much greater detail. No knowledge of ","type":"text"},{"code":"StoreKit2","type":"codeVoice"},{"type":"text","text":" or working with in-app purchases is assumed."}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"View the ","type":"text"},{"type":"codeVoice","code":"SKHelper"},{"type":"text","text":" project on "},{"isActive":true,"type":"reference","identifier":"https:\/\/github.com\/russell-archer\/SKHelper"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"View the "},{"overridingTitle":"Quick Start","overridingTitleInlineContent":[{"text":"Quick Start","type":"text"}],"identifier":"https:\/\/russell-archer.github.io\/SKHelper\/tutorials\/quickstart","type":"reference","isActive":true},{"type":"text","text":" on GitHub for an overview of how to get started"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"View the ","type":"text"},{"identifier":"https:\/\/github.com\/russell-archer\/SKHelperDemo","isActive":true,"type":"reference"},{"type":"text","text":" project on GitHub"}]}]}]},{"level":2,"text":"What is StoreKit?","type":"heading","anchor":"What-is-StoreKit"},{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"StoreKit"},{"text":" is the Apple framework that provides API support for working the with the App Store to enable your app to offer in-app purchases and subscriptions. Itâ€™s important to distinguish between ","type":"text"},{"code":"StoreKit2","type":"codeVoice"},{"type":"text","text":" (introduced September 2021) and "},{"type":"codeVoice","code":"StoreKit1"},{"type":"text","text":", which was introduced in 2009 and  "},{"type":"strong","inlineContent":[{"text":"deprecated","type":"text"}]},{"type":"text","text":" when Xcode 16 was launched in September 2024. Apple sometimes refers to "},{"type":"codeVoice","code":"StoreKit1"},{"text":" as the â€œoriginal API for in-app purchaseâ€.","type":"text"}]},{"content":[{"inlineContent":[{"text":"ğŸ‘‰ In this document whenever we refer to ","type":"text"},{"type":"codeVoice","code":"StoreKit"},{"type":"text","text":" we mean "},{"type":"codeVoice","code":"StoreKit2"},{"text":", the second major version of StoreKit.","type":"text"}],"type":"paragraph"}],"name":"Note","style":"note","type":"aside"},{"level":2,"anchor":"What-is-SKHelper","text":"What is SKHelper?","type":"heading"},{"inlineContent":[{"type":"codeVoice","code":"SKHelper"},{"type":"text","text":" is  a lightweight "},{"code":"StoreKit","type":"codeVoice"},{"type":"text","text":" "},{"inlineContent":[{"type":"text","text":"SwiftUI"}],"type":"strong"},{"text":" helper package that logically sits between your app and ","type":"text"},{"type":"codeVoice","code":"StoreKit"},{"text":" to provide support for implementing in-app purchases and subscriptions in ","type":"text"},{"inlineContent":[{"type":"text","text":"Xcode 16, iOS 17+"}],"type":"strong"},{"text":"Â andÂ ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"macOS 14.6+"}]},{"type":"text","text":". Note that support forÂ "},{"inlineContent":[{"text":"consumable","type":"text"}],"type":"strong"},{"text":"Â transactions requiresÂ ","type":"text"},{"type":"strong","inlineContent":[{"text":"iOS 18+","type":"text"}]},{"text":"Â andÂ ","type":"text"},{"inlineContent":[{"text":"macOS 15+","type":"text"}],"type":"strong"},{"text":".","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"Designed to be an easier-to-use refactoring of myÂ ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/russell-archer\/StoreHelper"},{"type":"text","text":"Â package, "},{"type":"codeVoice","code":"SKHelper"},{"text":" makes use of Appleâ€™sÂ ","type":"text"},{"inlineContent":[{"type":"text","text":"StoreKit Views"}],"type":"strong"},{"type":"text","text":"Â to provide a standard and easily customizable UI."}]},{"type":"paragraph","inlineContent":[{"identifier":"guide1.png","type":"image"}]},{"level":2,"anchor":"Source-Code","type":"heading","text":"Source Code"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The latest version of "},{"code":"SKHelper","type":"codeVoice"},{"type":"text","text":" is always available "},{"type":"reference","overridingTitleInlineContent":[{"text":"on GitHub","type":"text"}],"overridingTitle":"on GitHub","identifier":"https:\/\/github.com\/russell-archer\/SKHelper","isActive":true},{"type":"text","text":"."}]},{"name":"Note","type":"aside","content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"The source code presented here and in the "},{"type":"codeVoice","code":"SKHelper"},{"type":"text","text":" package is for educational purposes."}]},{"text":"","type":"text"},{"text":" ","type":"text"},{"inlineContent":[{"type":"text","text":"You may freely reuse and amend this code for use in your own apps. However, you do so entirely at your own risk."}],"type":"strong"}]}],"style":"note"},{"level":2,"type":"heading","text":"References","anchor":"References"},{"inlineContent":[{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/storekit","isActive":true}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/supporting_promoted_in-app_purchases_in_your_app","isActive":true}]},{"type":"paragraph","inlineContent":[{"isActive":true,"identifier":"https:\/\/developer.apple.com\/videos\/play\/wwdc2024\/10061\/","type":"reference"}]},{"level":2,"type":"heading","text":"What does this document provide?","anchor":"What-does-this-document-provide"},{"inlineContent":[{"type":"text","text":"This document discusses how to use Appleâ€™s "},{"code":"StoreKit","type":"codeVoice"},{"type":"text","text":" and the "},{"type":"codeVoice","code":"SKHelper"},{"type":"text","text":" framework to provide in-app purchases in your "},{"type":"strong","inlineContent":[{"text":"iOS","type":"text"}]},{"type":"text","text":" or "},{"type":"strong","inlineContent":[{"text":"macOS","type":"text"}]},{"type":"text","text":" "},{"type":"strong","inlineContent":[{"type":"text","text":"SwiftUI"}]},{"text":"-based apps. Specifically, weâ€™ll cover:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"How to use the "},{"code":"SKHelper","type":"codeVoice"},{"type":"text","text":" package to create iOS and macOS SwiftUI apps that allows users to purchase a range of products:"}]},{"items":[{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Consumables"}]}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Non-consumables","type":"text"}]}]}]},{"content":[{"inlineContent":[{"inlineContent":[{"text":"Subscriptions","type":"text"}],"type":"strong"}],"type":"paragraph"}]}],"type":"unorderedList"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"An in-depth review of how to use "},{"code":"SKHelper","type":"codeVoice"},{"text":", a Swift package that encapsulates ","type":"text"},{"type":"codeVoice","code":"StoreKit"},{"type":"text","text":" in-app purchase functionality and makes it easy to work with the App Store"}]}]},{"content":[{"inlineContent":[{"text":"Developing a demo app for an on-line florist that sells a range of flowers and other related services like home visits to water and care for house plants","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Requesting localized "},{"inlineContent":[{"type":"text","text":"product information"}],"type":"strong"},{"text":" from the App Store","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"How to ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"purchase"}]},{"text":" a product and ","type":"text"},{"type":"strong","inlineContent":[{"text":"validate the transaction","type":"text"}]}]}]},{"content":[{"inlineContent":[{"text":"Handling ","type":"text"},{"inlineContent":[{"text":"pending (â€œask to buyâ€) transactions","type":"text"}],"type":"strong"},{"text":" where parental permission must be obtained before a purchase is completed","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Handling ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"cancelled"}]},{"type":"text","text":" and "},{"inlineContent":[{"text":"failed transactions","type":"text"}],"type":"strong"}]}]},{"content":[{"inlineContent":[{"text":"Handling customer ","type":"text"},{"type":"strong","inlineContent":[{"text":"refunds","type":"text"}]}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Managing "},{"inlineContent":[{"text":"subscriptions","type":"text"}],"type":"strong"},{"type":"text","text":", including upgrading, downgrading and cancelling"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Exploring detailed "},{"type":"strong","inlineContent":[{"text":"transaction information and history","type":"text"}]},{"type":"text","text":" for consumables, non-consumables and subscriptions"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Testing purchases locally using ","type":"text"},{"type":"strong","inlineContent":[{"text":"StoreKit configuration","type":"text"}]},{"type":"text","text":" files"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Support for direct App Store purchases of "},{"type":"strong","inlineContent":[{"text":"promoted in-app purchases","type":"text"}]}]}]}],"type":"unorderedList"},{"anchor":"Do-I-really-need-SKHelper","text":"Do I really need SKHelper?","level":2,"type":"heading"},{"inlineContent":[{"text":"No, you donâ€™t. You can easily develop you own code to support in-app purchases, particularly now that ","type":"text"},{"type":"codeVoice","code":"StoreKit"},{"type":"text","text":" provides SwiftUI views and view modifiers to enable user purchases. Prior to the introduction of "},{"type":"codeVoice","code":"StoreKit2"},{"type":"text","text":", things were more complicated and there were three areas of particular difficulty:"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Creating a purchase UI"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Validating purchases","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Working with delegate-based APIs.","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"StoreKit2"},{"type":"text","text":" addresses all these issues, and more:"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"StoreKit Views","type":"text"}]},{"type":"text","text":" enable the presentation of a standardized, customizable purchase UI"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Transactions are ","type":"text"},{"inlineContent":[{"type":"text","text":"automatically"}],"type":"strong"},{"type":"text","text":" validated against the App Store receipt"}]}]},{"content":[{"inlineContent":[{"text":"The ","type":"text"},{"code":"async","type":"codeVoice"},{"text":"\/","type":"text"},{"code":"await","type":"codeVoice"},{"type":"text","text":" pattern is used throughout the API"}],"type":"paragraph"}]}]},{"inlineContent":[{"type":"text","text":"However, even if you develop your own in-app purchase code there are still a few areas of complexity, particularly with regard to subscriptions. Youâ€™ll probably end up creating something very similar to "},{"type":"codeVoice","code":"SKHelper"},{"type":"text","text":"!"}],"type":"paragraph"},{"text":"The SKHelperDemo App","anchor":"The-SKHelperDemo-App","type":"heading","level":2},{"type":"paragraph","inlineContent":[{"identifier":"guide2.png","type":"image"}]},{"inlineContent":[{"text":"The best way to get familiar with ","type":"text"},{"code":"StoreKit","type":"codeVoice"},{"type":"text","text":" and "},{"code":"SKHelper","type":"codeVoice"},{"type":"text","text":" is to create a simple, but full-featured (from an in-app purchase perspective) demo app. You may be surprised how little code is required to implement in-app purchases: "},{"type":"codeVoice","code":"SKHelper"},{"type":"text","text":" and "},{"type":"codeVoice","code":"StoreKit"},{"type":"text","text":" handle all the heavy-lifting!"}],"type":"paragraph"},{"anchor":"What-are-we-building","level":3,"type":"heading","text":"What are we building?"},{"type":"paragraph","inlineContent":[{"type":"text","text":"In this guide weâ€™ll be developing a demo app ("},{"inlineContent":[{"type":"text","text":"SKHelperDemo"}],"type":"strong"},{"text":") for an on-line florist that sells a range of flowers and other related services like home visits to water and care for house plants. Weâ€™ll develop the app for both macOS and iOS, using a single multi-platform Xcode project.","type":"text"}]},{"level":3,"text":"Prerequisites","type":"heading","anchor":"Prerequisites"},{"inlineContent":[{"type":"text","text":"Before getting started youâ€™ll need to download "},{"type":"strong","inlineContent":[{"type":"text","text":"Xcode 16"}]},{"type":"text","text":", along with the "},{"inlineContent":[{"text":"iOS 18 SDK and simulator","type":"text"}],"type":"strong"},{"type":"text","text":"."}],"type":"paragraph"},{"level":3,"type":"heading","text":"Get Started","anchor":"Get-Started"},{"type":"paragraph","inlineContent":[{"type":"text","text":"To get started, create a new "},{"inlineContent":[{"type":"text","text":"multi-platform"}],"type":"strong"},{"text":" Xcode project and name it ","type":"text"},{"inlineContent":[{"type":"text","text":"SKHelperDemo:"}],"type":"strong"}]},{"type":"paragraph","inlineContent":[{"identifier":"quickstart1.png","type":"image"}]},{"inlineContent":[{"type":"text","text":"Once Xcode has created the project selectÂ "},{"inlineContent":[{"text":"File > Add Package Dependencies","type":"text"}],"type":"strong"},{"type":"text","text":":"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"quickstart2.png"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"In the search field enter the URL of theÂ "},{"type":"strong","inlineContent":[{"type":"text","text":"SKHelper"}]},{"type":"text","text":"Â package on GitHub and tapÂ "},{"type":"strong","inlineContent":[{"text":"Add Package:","type":"text"}]}]},{"type":"aside","style":"note","content":[{"inlineContent":[{"type":"text","text":"ğŸ‘‰ The URL of theÂ "},{"type":"strong","inlineContent":[{"text":"SKHelper","type":"text"}]},{"type":"text","text":"Â package is:Â "},{"overridingTitle":"https:\/\/github.com\/russell-archer\/SKHelper","isActive":true,"overridingTitleInlineContent":[{"type":"text","text":"https:\/\/github.com\/russell-archer\/SKHelper"}],"type":"reference","identifier":"https:\/\/github.com\/russell-archer\/SKHelper"}],"type":"paragraph"}],"name":"Note"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide3.png"}]},{"inlineContent":[{"text":"Xcode will now retrieve theÂ ","type":"text"},{"inlineContent":[{"type":"text","text":"SKHelper"}],"type":"strong"},{"type":"text","text":"Â package from GitHub. When prompted, tapÂ "},{"type":"strong","inlineContent":[{"type":"text","text":"Add Package"}]},{"type":"text","text":"Â to add the package to your project:"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"quickstart4.png"}]},{"inlineContent":[{"type":"text","text":"We now need to add the necessary in-app purchase capabilities to our project. Select your projectâ€™s target and navigate to theÂ "},{"type":"strong","inlineContent":[{"type":"text","text":"Signing & Capabilities"}]},{"type":"text","text":"Â tab. Tap theÂ "},{"type":"strong","inlineContent":[{"type":"text","text":"+ Capability"}]},{"type":"text","text":"Â button and add theÂ "},{"type":"strong","inlineContent":[{"text":"In-App Purchase","type":"text"}]},{"type":"text","text":"Â capability to your project:"}],"type":"paragraph"},{"inlineContent":[{"type":"image","identifier":"guide4.png"}],"type":"paragraph"},{"type":"heading","level":3,"anchor":"Configuring-products","text":"Configuring products"},{"inlineContent":[{"type":"text","text":"Before we do anything else we need to define the products weâ€™ll be selling. Ultimately, this will need to be done inÂ "},{"inlineContent":[{"text":"App Store Connect","type":"text"}],"type":"strong"},{"type":"text","text":". However, Xcode provides us with an local, on-device way of experimenting with in-app purchases."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"StoreKit Testing","type":"text"}]},{"type":"text","text":", introduced in Xcode 12, is a test environment allows you to do early testing of in-app purchases in the simulator, without having to set anything up in App Store Connect. You define your products locally in aÂ "},{"type":"strong","inlineContent":[{"type":"text","text":"StoreKit Configuration"}]},{"type":"text","text":" file. Furthermore, you can view and delete transactions, issue refunds, cancel subscriptions, and a whole lot more. Thereâ€™s also a newÂ "},{"inlineContent":[{"type":"text","text":"StoreKitTest"}],"type":"strong"},{"type":"text","text":"Â framework that enables you to do automated testing of IAPs."}]},{"type":"heading","text":"Localized product information","anchor":"Localized-product-information","level":4},{"type":"paragraph","inlineContent":[{"text":"Each product that we will sell in our app is identified by a unique ","type":"text"},{"type":"codeVoice","code":"ProductId"},{"type":"text","text":". You can either hard-code these ids into your app, or store them in an easily-modifiable property list file. In our demo app weâ€™ll use the property list approach."}]},{"inlineContent":[{"text":"When our demo app runs it will need to getÂ ","type":"text"},{"type":"emphasis","inlineContent":[{"type":"text","text":"localized"}]},{"type":"text","text":"Â product information. This includes things like a productâ€™s name and description in the appropriate local language, and prices in the local currency. When an app has been released, or when using "},{"inlineContent":[{"text":"Sandbox testing","type":"text"}],"type":"strong"},{"type":"text","text":" (more on this later) this information comes from the App Store. When using local Xcode StoreKit testing the information comes from the StoreKit Configuration file."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The switch between local StoreKit testing and the App Store is transparent in terms of our in-app purchase code: itâ€™s a simple configuration change."}]},{"type":"paragraph","inlineContent":[{"text":"The following diagram shows the arrangement for requesting localized product information:","type":"text"}]},{"type":"paragraph","inlineContent":[{"identifier":"guide5.png","type":"image"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"We create a list of product ids and provide them to "},{"code":"SKHelper","type":"codeVoice"},{"type":"text","text":" via a "},{"inlineContent":[{"type":"text","text":"Products.plist"}],"type":"strong"},{"text":" file","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"The ","type":"text"},{"type":"codeVoice","code":"SKHelper.requestProducts()"},{"type":"text","text":" method calls the"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"StoreKit "},{"type":"codeVoice","code":"Product.products(for:)"},{"type":"text","text":" method, passing the list of products ids"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"In production, a call is made to the App Store to get localized product info. If the project is configured to use StoreKit testing localized product information is returned from the ","type":"text"},{"code":"Products.storekit","type":"codeVoice"},{"type":"text","text":" configuration file"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"The resulting localized product information is stored in the "},{"type":"codeVoice","code":"SKHelper.products"},{"type":"text","text":" property"}],"type":"paragraph"}]}],"type":"orderedList"},{"level":4,"text":"The Products.plist file","anchor":"The-Productsplist-file","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"Create a newÂ ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"Property List"}]},{"text":"Â file in your project and name itÂ ","type":"text"},{"type":"strong","inlineContent":[{"text":"Products.plist","type":"text"}]},{"type":"text","text":". Paste the contents of the exampleÂ "},{"type":"strong","inlineContent":[{"type":"text","text":"Products.plist"}]},{"text":"Â file shown into yourÂ ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"Products.list"}]},{"type":"text","text":"Â file."}]},{"style":"note","type":"aside","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"ğŸ‘‰ The "},{"inlineContent":[{"type":"text","text":"Products.plist"}],"type":"strong"},{"type":"text","text":" file doesnâ€™t "},{"type":"emphasis","inlineContent":[{"text":"have","type":"text"}]},{"text":" to be named ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"Products.plist"}]},{"type":"text","text":", but by default "},{"type":"codeVoice","code":"SKHelper"},{"type":"text","text":" looks for a file of that name."}]}],"name":"Note"},{"type":"paragraph","inlineContent":[{"type":"text","text":"If you want to change it (and other configuration values) to something else you can create a custom configuration file in your project. See "},{"type":"strong","inlineContent":[{"type":"text","text":"Configuration.plist"}]},{"type":"text","text":" in the "},{"inlineContent":[{"type":"text","text":"SKHelper > Samples > Configuration"}],"type":"strong"},{"type":"text","text":" folder for an example."}]},{"type":"paragraph","inlineContent":[{"text":"You can tell ","type":"text"},{"code":"SKHelper","type":"codeVoice"},{"type":"text","text":" to use the custom configuration to override default values when you initialize it:"}]},{"type":"codeListing","syntax":"swift","code":["\/\/ Use a custom configuration file named \"Configuration.plist\"","@State private var store = SKHelper(customConfiguration: \"Configuration\")"]},{"inlineContent":[{"text":"In the Xcode ","type":"text"},{"inlineContent":[{"type":"text","text":"Project navigator"}],"type":"strong"},{"text":" pane, right-click the property list you just created and select ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"Open As > Source Code"}]},{"text":". Paste the following data into the file:","type":"text"}],"type":"paragraph"},{"syntax":"xml","type":"codeListing","code":["<?xml version=\"1.0\" encoding=\"UTF-8\"?>","<!DOCTYPE plist PUBLIC \"-\/\/Apple\/\/DTD PLIST 1.0\/\/EN\" \"http:\/\/www.apple.com\/DTDs\/PropertyList-1.0.dtd\">","<plist version=\"1.0\">","<dict>","    <key>Products<\/key>","    <array>","        <string>com.rarcher.nonconsumable.flowers.large<\/string>","        <string>com.rarcher.nonconsumable.flowers.small<\/string>","        <string>com.rarcher.consumable.plant.installation<\/string>","    <\/array>","    <key>Subscriptions<\/key>","    <array>","        <dict>","            <key>Group<\/key>","            <string>vip<\/string>","            <key>Products<\/key>","            <array>","                <string>com.rarcher.subscription.vip.gold<\/string>","                <string>com.rarcher.subscription.vip.silver<\/string>","            <\/array>","        <\/dict>","    <\/array>","<\/dict>","<\/plist>"]},{"name":"Note","style":"note","type":"aside","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"ğŸ‘‰ Make sure to include "},{"type":"strong","inlineContent":[{"type":"text","text":"Products.plist"}]},{"type":"text","text":" in theÂ "},{"inlineContent":[{"type":"text","text":"Target Membership"}],"type":"strong"},{"text":"Â for both the iOS and macOS targets. This is because weâ€™ll need the list of product ids in both testing and release builds.","type":"text"}]}]},{"inlineContent":[{"type":"text","text":"Notice "},{"inlineContent":[{"type":"text","text":"consumable"}],"type":"strong"},{"type":"text","text":" and "},{"inlineContent":[{"type":"text","text":"non-consumable"}],"type":"strong"},{"text":" (see below for definitions) products are listed in the ","type":"text"},{"code":"Products","type":"codeVoice"},{"type":"text","text":" section, with "},{"inlineContent":[{"type":"text","text":"subscriptions"}],"type":"strong"},{"type":"text","text":" listed in the "},{"type":"codeVoice","code":"Subscriptions"},{"text":" section.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Also note that weâ€™ve adopted a "},{"inlineContent":[{"text":"naming convention","type":"text"}],"type":"strong"},{"type":"text","text":" for our product ids:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"emphasis","inlineContent":[{"text":"com.developer.product-type.name","type":"text"}]},{"type":"text","text":" for consumables and non-consumables, and"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"com.developer.subscription.group.name"}],"type":"emphasis"},{"type":"text","text":" for subscriptions"}]}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"This isnâ€™t strictly necessary, so product ids like â€œlarge-flowersâ€ and â€œgoldâ€ are also perfectly acceptable as product ids only need to be unique within each particular app."}]},{"level":4,"anchor":"Product-types","text":"Product types","type":"heading"},{"inlineContent":[{"text":"At this point we need to discuss product ","type":"text"},{"inlineContent":[{"text":"types","type":"text"}],"type":"emphasis"},{"text":". ","type":"text"},{"type":"codeVoice","code":"SKHelper"},{"text":" supports three types of product.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Consumables","type":"text"}]}]},{"type":"paragraph","inlineContent":[{"text":"This type of product represents something that can be purchased and then â€œused upâ€ in some way. The user can purchase multiples of this type of product.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"For example, a consumable product might be an â€œsuper-powers tokenâ€ that grants the user extra abilities, for a limited time, in a game. In our demo we offer a consumable that represents an on-site visit to water and care for your plants. The product lasts for one visit and then expires. The user may purchase as many visits as they want."}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Non-consumables"}],"type":"strong"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"A non-consumable product is a something the user purchases once and which lasts â€œforeverâ€. An example would be purchasing access to â€œpro-levelâ€ functionality in a camera app. In our demo we sell non-consumable products like flowers and chocolates."}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Auto-renewable subscriptions"}]}]},{"inlineContent":[{"text":"An auto-renewable subscription represents a service that requires a regular payment. For example, a specialist skiing weather app might requires a monthly subscription. The user may cancel the subscription at any time, in which case access to the service will end when the next renewal payment becomes due.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Note that subscriptions are offered as part of a "},{"type":"strong","inlineContent":[{"type":"text","text":"group"}]},{"text":" of subscription products. For example, in the demo app we define a â€œVIPâ€ subscription group (see Products.plist above) which contains two product ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"levels"}]},{"type":"text","text":": â€œgoldâ€ (the highest value) and â€œsilverâ€. The position of the product id in the file determines the "},{"type":"strong","inlineContent":[{"text":"product level","type":"text"}]},{"type":"text","text":" or "},{"type":"strong","inlineContent":[{"text":"value","type":"text"}]},{"text":". Products that appear towards the top of the file are of higher value than those defined towards the bottom of the file. Weâ€™ll see later how easy it is to support users upgrading, downgrading or cancelling subscriptions.","type":"text"}]},{"type":"aside","name":"Note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"ğŸ‘‰ Note that SKHelper does not support the older type of "},{"inlineContent":[{"type":"text","text":"non"}],"type":"emphasis"},{"type":"text","text":"-renewable subscription, the use of which is discouraged by Apple."}]}],"style":"note"},{"text":"The StoreKit Configuration file","type":"heading","anchor":"The-StoreKit-Configuration-file","level":4},{"type":"paragraph","inlineContent":[{"text":"We can now create the StoreKit configuration file that will be used to provide localized product data during initial development and testing.","type":"text"}]},{"inlineContent":[{"type":"text","text":"Create aÂ "},{"type":"strong","inlineContent":[{"text":"StoreKit Configuration File","type":"text"}]},{"type":"text","text":"Â by selectingÂ "},{"inlineContent":[{"type":"text","text":"File > New > File"}],"type":"strong"},{"type":"text","text":"Â and choosing theÂ "},{"inlineContent":[{"type":"text","text":"StoreKit Configuration File"}],"type":"strong"},{"text":" template:","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"image","identifier":"quickstart9.png"}],"type":"paragraph"},{"inlineContent":[{"text":"From Xcode 14 onwards you can choose to create aÂ ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"synced"}]},{"text":"Â ","type":"text"},{"type":"codeVoice","code":".storekit"},{"text":"Â configuration file that is linked to in-app purchases already defined in App Store Connect. Once youâ€™ve created the syncedÂ ","type":"text"},{"type":"codeVoice","code":".storekit"},{"type":"text","text":"Â configuration file you canâ€™t edit it locally in Xcode, all changes have to be made in App Store Connect."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"After clickingÂ "},{"type":"strong","inlineContent":[{"text":"Next","type":"text"}]},{"text":"Â youâ€™ll be asked if you want to create a syncedÂ ","type":"text"},{"code":".storekit","type":"codeVoice"},{"type":"text","text":"Â configuration file:"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide6.png"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"If you choose to sync your StoreKit configuration file with the App Store youâ€™ll be prompted to select one of your apps in App Store Connect:"}]},{"inlineContent":[{"identifier":"guide7.png","type":"image"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"For the purposes of our demo we wonâ€™t create a synced configuration file.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"Open the newly created ","type":"text"},{"inlineContent":[{"text":"Products.storekit","type":"text"}],"type":"strong"},{"text":" file (you can name it anything you like) and click the â€œ+â€ at the bottom-left of the window. Youâ€™ll be prompted to select the type of product you want to create:","type":"text"}]},{"type":"paragraph","inlineContent":[{"identifier":"guide8.png","type":"image"}]},{"inlineContent":[{"type":"text","text":"Create a "},{"type":"strong","inlineContent":[{"type":"text","text":"Consumable"}]},{"text":" in-app purchase and provide a ","type":"text"},{"inlineContent":[{"text":"Reference Name","type":"text"}],"type":"strong"},{"type":"text","text":" and "},{"inlineContent":[{"type":"text","text":"Product ID"}],"type":"strong"},{"text":":","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"image","identifier":"guide9.png"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"The configuration file will open, allowing you to add pricing details and localization information:","type":"text"}]},{"type":"paragraph","inlineContent":[{"identifier":"guide10.png","type":"image"}]},{"inlineContent":[{"type":"text","text":"For now, just add a "},{"inlineContent":[{"text":"Display Name","type":"text"}],"type":"strong"},{"type":"text","text":" and "},{"inlineContent":[{"type":"text","text":"Description"}],"type":"strong"},{"type":"text","text":" for English (U.S.):"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide11.png"}]},{"type":"paragraph","inlineContent":[{"text":"Notice under the ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"APP"}]},{"type":"text","text":" section in the left pane you can configure various test settings and app policies:"}]},{"type":"paragraph","inlineContent":[{"identifier":"guide12.png","type":"image"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Weâ€™ll come back to alter some of these settings later. For now, create two new non-consumable in-app purchases with the following details:"}]},{"inlineContent":[{"text":"| ","type":"text"},{"inlineContent":[{"text":"Reference Name","type":"text"}],"type":"strong"},{"text":" | ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"Product ID"}]},{"type":"text","text":" | "},{"inlineContent":[{"text":"Price (see note below)","type":"text"}],"type":"strong"},{"type":"text","text":" | "},{"inlineContent":[{"text":"English (U.S.)","type":"text"},{"type":"text","text":" "},{"text":"Display Name","type":"text"}],"type":"strong"},{"text":" | ","type":"text"},{"inlineContent":[{"text":"English (U.S.)","type":"text"},{"type":"text","text":" "},{"text":"Description","type":"text"}],"type":"strong"},{"type":"text","text":" |"},{"text":" ","type":"text"},{"text":"| â€” | â€” | â€” | â€” | â€” |","type":"text"},{"type":"text","text":" "},{"text":"| Flowers Large | ","type":"text"},{"type":"codeVoice","code":"com.rarcher.nonconsumable.flowers.large"},{"text":" | 1.99 | Large Flowers | A beautiful large bunch of seasonal flowers. |","type":"text"},{"text":" ","type":"text"},{"text":"| Flowers Small | ","type":"text"},{"code":"com.rarcher.nonconsumable.flowers.small","type":"codeVoice"},{"type":"text","text":" | 0.99 | Small Flowers | A beautiful small bunch of seasonal flowers. |"}],"type":"paragraph"},{"style":"note","content":[{"inlineContent":[{"type":"text","text":"ğŸ‘‰ These price values are a hard-coded test price for the product. Before deploying to the App Store, youâ€™ll configure real prices for your appâ€™s in-app purchases and subscriptions in App Store Connect. In production your app will request localized price (and other) information from the App Store."}],"type":"paragraph"}],"type":"aside","name":"Note"},{"style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"ğŸ‘‰ Note also that none of the data defined in the local (non-synced)Â "},{"code":".storekit","type":"codeVoice"},{"text":"Â file is ","type":"text"},{"inlineContent":[{"text":"ever","type":"text"}],"type":"emphasis"},{"text":" uploaded to App Store Connect. Itâ€™s only used when testing in-app purchases locally in Xcode. No real user will ever see this test data.","type":"text"}]}],"type":"aside","name":"Note"},{"inlineContent":[{"type":"text","text":"Your "},{"type":"strong","inlineContent":[{"type":"text","text":"Products.storekit"}]},{"type":"text","text":" configuration file should now look like this:"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide13.png"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Now weâ€™ll create our subscription products. Click the â€œ+â€ and select "},{"type":"strong","inlineContent":[{"text":"Add Auto-Renewable Subscription","type":"text"}]},{"text":".","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Youâ€™ll first be prompted to create a new subscription group. Name your group â€œ"},{"type":"strong","inlineContent":[{"type":"text","text":"vipâ€"}]},{"text":":","type":"text"}]},{"type":"paragraph","inlineContent":[{"identifier":"guide14.png","type":"image"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Next, provide a "},{"type":"strong","inlineContent":[{"type":"text","text":"Reference Name"}]},{"type":"text","text":" of â€œ"},{"type":"strong","inlineContent":[{"type":"text","text":"Silverâ€"}]},{"type":"text","text":" and "},{"type":"strong","inlineContent":[{"text":"Product ID","type":"text"}]},{"type":"text","text":" of "},{"type":"codeVoice","code":"com.rarcher.subscription.vip.silver"},{"text":":","type":"text"}]},{"inlineContent":[{"identifier":"guide15.png","type":"image"}],"type":"paragraph"},{"inlineContent":[{"text":"Youâ€™ll see that the StoreKit configuration file provides a range of offers and promotions. Ignore those for now and add the following details:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Price: 29.99","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Display Name (English U.S.): "},{"type":"strong","inlineContent":[{"type":"text","text":"Silver Service"}]}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description (English U.S.): "},{"inlineContent":[{"type":"text","text":"Personal care for your plants"}],"type":"strong"},{"type":"text","text":"."}]}]}]},{"inlineContent":[{"text":"Now create a new â€œGoldâ€ subscription with the following details:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Reference Name: Gold"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Product ID: "},{"type":"codeVoice","code":"com.rarcher.subscription.vip.gold"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Price: 39.99"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Display Name (English U.S.): "},{"inlineContent":[{"type":"text","text":"Gold Service"}],"type":"strong"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Description (English U.S.): ","type":"text"},{"inlineContent":[{"type":"text","text":"A touch of luxury for you plants."}],"type":"strong"}]}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Finally, letâ€™s create an introductory offer for the Gold product."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"In the "},{"type":"strong","inlineContent":[{"text":"Introductory Offer","type":"text"}]},{"type":"text","text":" section, set the "},{"inlineContent":[{"text":"Offer Type","type":"text"}],"type":"strong"},{"type":"text","text":" to be "},{"type":"strong","inlineContent":[{"type":"text","text":"Free"}]},{"type":"text","text":" and the "},{"inlineContent":[{"type":"text","text":"Duration"}],"type":"strong"},{"text":" to be ","type":"text"},{"type":"strong","inlineContent":[{"text":"3 Days","type":"text"}]},{"text":":","type":"text"}]},{"inlineContent":[{"identifier":"guide16.png","type":"image"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"If you now select the â€œvipâ€ group in the left pane youâ€™ll be able to configure settings for the group as a whole. Make sure that the â€œgoldâ€ subscription (the most valuable) is at the top of the list by setting its "},{"inlineContent":[{"type":"text","text":"Level value"}],"type":"strong"},{"text":" to ","type":"text"},{"type":"strong","inlineContent":[{"text":"1","type":"text"}]},{"text":". Also ensure that â€œsilverâ€ is set to level ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"2"}]},{"type":"text","text":":"}]},{"type":"paragraph","inlineContent":[{"identifier":"guide17.png","type":"image"}]},{"text":"Why do we have two product lists?!","type":"heading","level":3,"anchor":"Why-do-we-have-two-product-lists"},{"inlineContent":[{"text":"At this point you may very reasonably be wondering why we have a ","type":"text"},{"inlineContent":[{"text":"Products.storekit","type":"text"}],"type":"strong"},{"type":"text","text":" configuration file "},{"type":"emphasis","inlineContent":[{"text":"and","type":"text"}]},{"type":"text","text":" a "},{"inlineContent":[{"type":"text","text":"Products.plist"}],"type":"strong"},{"text":" file. Couldnâ€™t we just make do with one, because data (product ids) is duplicated in the two files?","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"There is a fundamental principle in software development that may be summarized by the ","type":"text"},{"inlineContent":[{"text":"DRY","type":"text"}],"type":"strong"},{"type":"text","text":" mnemonic: "},{"inlineContent":[{"text":"D","type":"text"}],"type":"strong"},{"type":"text","text":"onâ€™t "},{"type":"strong","inlineContent":[{"text":"R","type":"text"}]},{"text":"epeat ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"Y"}]},{"text":"ourself. Essentially, if you find youâ€™ve duplicated code or data you should generally find a way of abstracting it into a single entity, and then referencing that entity as required from multiple places. Experience shows that if youâ€™ve got basically the same thing scattered throughout your project, if you need to modify it thereâ€™s a good chance youâ€™ll forgot to update ","type":"text"},{"type":"emphasis","inlineContent":[{"type":"text","text":"all"}]},{"type":"text","text":" the occurrences. This can lead to difficult-to-find bugs and misery!"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"So, because weâ€™ve defined our products in the StoreKit configuration file, it seems obvious that we should use ","type":"text"},{"inlineContent":[{"type":"text","text":"that"}],"type":"strong"},{"type":"text","text":" as the repository for our product id data. Retrieving configuration data at runtime from the "},{"code":".storekit","type":"codeVoice"},{"text":" file isnâ€™t difficult (itâ€™sÂ ","type":"text"},{"type":"codeVoice","code":"JSON"},{"text":"). However, theÂ ","type":"text"},{"code":".storekit","type":"codeVoice"},{"text":"configuration file is intended for useÂ ","type":"text"},{"type":"emphasis","inlineContent":[{"type":"text","text":"when testing"}]},{"text":"Â and itâ€™s really ","type":"text"},{"inlineContent":[{"type":"text","text":"not"}],"type":"strong"},{"text":" a good idea to use it for production too. This is why the ","type":"text"},{"type":"codeVoice","code":".storekit"},{"text":" file is not included in any of your targets by default. It would be all too easy to allow â€œtest productsâ€ to somehow make it into the release build! So, in this case itâ€™s better to violate the DRY principle, rather than risk something far worse!","type":"text"}]},{"type":"heading","level":3,"anchor":"Enable-StoreKit-Testing","text":"Enable StoreKit Testing"},{"inlineContent":[{"text":"Before moving on to other topics, weâ€™ll need to ","type":"text"},{"inlineContent":[{"type":"text","text":"enable"}],"type":"emphasis"},{"type":"text","text":" StoreKit testing in Xcode, as itâ€™s disabled by default."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"SelectÂ ","type":"text"},{"type":"strong","inlineContent":[{"text":"Product > Scheme > Edit Scheme","type":"text"}]},{"text":". Now selectÂ ","type":"text"},{"inlineContent":[{"type":"text","text":"Run"}],"type":"strong"},{"type":"text","text":"Â and theÂ "},{"type":"strong","inlineContent":[{"type":"text","text":"Options"}]},{"type":"text","text":"Â tab. You can now select the configuration file from theÂ "},{"type":"strong","inlineContent":[{"text":"StoreKit Configuration","type":"text"}]},{"text":"Â list:","type":"text"}]},{"inlineContent":[{"type":"image","identifier":"quickstart12.png"}],"type":"paragraph"},{"text":"Configure product images","type":"heading","anchor":"Configure-product-images","level":3},{"type":"paragraph","inlineContent":[{"text":"In theÂ ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"SKHelper"}]},{"text":"Â package, navigate to theÂ ","type":"text"},{"inlineContent":[{"text":"Samples\/Images","type":"text"}],"type":"strong"},{"text":"Â folder. Select the images that have filenames that start with â€œcomâ€ then right-click them and selectÂ ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"Show in Finder"}]},{"type":"text","text":"."}]},{"inlineContent":[{"type":"text","text":"Locate the file named â€œplant-servicesâ€ and add that to your selection."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"Drag all the selected images from Finder into your projectâ€™s asset catalog:","type":"text"}]},{"inlineContent":[{"identifier":"quickstart10.png","type":"image"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Notice that each product has an image with a filename that corresponds to the product id."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Switch back to Finder and use the files with names that start with â€œSKHelperDemoâ€ to populate the asset catalogâ€™s "},{"inlineContent":[{"text":"AppIcon","type":"text"}],"type":"strong"},{"type":"text","text":" image set:"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide18.png"}]},{"text":"Displaying a list of products","type":"heading","anchor":"Displaying-a-list-of-products","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"Having configured our products, letâ€™s see how easy it is to display a list of them using "},{"code":"SKHelper","type":"codeVoice"},{"type":"text","text":"."}]},{"inlineContent":[{"type":"text","text":"Open the projectâ€™sÂ "},{"type":"strong","inlineContent":[{"type":"text","text":"SKHelperDemoApp.swift"}]},{"text":" file and replace the contents with the code as shown. Notice how we create an instance of theÂ ","type":"text"},{"inlineContent":[{"type":"text","text":"SKHelper"}],"type":"strong"},{"type":"text","text":"Â object and add it to the view environment:"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["import SwiftUI","import SKHelper","","@main","struct SKHelperDemoApp: App {","    @State private var store = SKHelper()","    ","    var body: some Scene {","        WindowGroup {","            ContentView()","                .environment(store)","        }","    }","}"]},{"type":"paragraph","inlineContent":[{"text":"Now open ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"ContentView.swift"}]},{"text":"Â file and replace the contents with the code shown:","type":"text"}]},{"code":["import SwiftUI","import SKHelper","","struct ContentView: View {","    @Environment(SKHelper.self) private var store","    ","    var body: some View {","","        \/\/ SKHelperStoreView() lists all available products for this app.","        \/\/ Purchasing is supported. Purchased products will be grayed-out.","        \/\/ Tapping on a product's image shows details for that product.","        SKHelperStoreView()","    }","}","","#Preview { ContentView().environment(SKHelper()) }"],"type":"codeListing","syntax":"swift"},{"type":"paragraph","inlineContent":[{"code":"SKHelperStoreView()","type":"codeVoice"},{"type":"text","text":"Â uses a StoreKitÂ "},{"type":"codeVoice","code":"StoreView"},{"text":"Â (more on this later) to create a list of all our available products. WhenÂ ","type":"text"},{"code":"SKHelper","type":"codeVoice"},{"type":"text","text":"Â is instantiated, it reads theÂ "},{"inlineContent":[{"text":"Products.plist","type":"text"}],"type":"strong"},{"type":"text","text":"Â file we created previously and asks "},{"type":"codeVoice","code":"StoreKit"},{"text":" to fetch a collection of localized product information. This product information is stored inÂ ","type":"text"},{"type":"codeVoice","code":"SKHelper.products"},{"text":".","type":"text"}]},{"inlineContent":[{"type":"text","text":"If you now build and run the app you should see a list of all the products we configured earlier:"}],"type":"paragraph"},{"inlineContent":[{"identifier":"guide19.png","type":"image"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"Notice that:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Each product has a short text description, an image clipped to a circular shape and a price button"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"The list of products is sorted into groups by product type, with non-consumables shown first, then consumables, with subscriptions shown at the end of the list","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Tapping on the price button starts the standard purchase process for the product"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"There is a â€œRestore Missing Purchasesâ€ button, as required by the App Store"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Tapping on the productâ€™s image shows a sheet containing product details:","type":"text"}]}]}]},{"inlineContent":[{"type":"image","identifier":"guide20.png"}],"type":"paragraph"},{"anchor":"Testing-non-US-localizations","type":"heading","text":"Testing non-U.S. localizations","level":4},{"inlineContent":[{"text":"When you run the app youâ€™ll see that prices are in US dollars. This is because, by default in the StoreKit test environment, the App StoreÂ ","type":"text"},{"inlineContent":[{"type":"text","text":"Storefront"}],"type":"strong"},{"type":"text","text":"Â isÂ "},{"type":"strong","inlineContent":[{"text":"United States (USD)","type":"text"}]},{"type":"text","text":"Â and the localization isÂ "},{"type":"strong","inlineContent":[{"type":"text","text":"English (US)"}]},{"type":"text","text":". To support testing other locales you can change this."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Make sure theÂ "},{"type":"codeVoice","code":"Products.storekit"},{"text":"Â file is open, then selectÂ ","type":"text"},{"inlineContent":[{"type":"text","text":"Editor > Default Storefront"}],"type":"strong"},{"type":"text","text":"Â and change this to another value. You can also changed the localization fromÂ "},{"inlineContent":[{"type":"text","text":"English (US"}],"type":"strong"},{"type":"text","text":") withÂ "},{"inlineContent":[{"type":"text","text":"Editor > Default Localization"}],"type":"strong"},{"type":"text","text":". If you change the localization settings youâ€™ll need to make sure to add text matching that locale (e.g. French) to each product in the "},{"type":"codeVoice","code":".storekit"},{"type":"text","text":" file:"}]},{"inlineContent":[{"identifier":"guide21.png","type":"image"}],"type":"paragraph"},{"anchor":"Customizing-the-appearance-of-the-product-list","type":"heading","text":"Customizing the appearance of the product list","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"As you can see, you get so much functionality for just two lines of code! However, there are many ways in which you can customize how "},{"type":"codeVoice","code":"SKHelperStoreView"},{"text":" behaves. For example, we can modify the display of product details like this:","type":"text"}]},{"syntax":"swift","code":["struct ContentView: View {","    @Environment(SKHelper.self) private var store","    ","    var body: some View {","","        SKHelperStoreView() { productId in","            \/\/ When the use taps on the product's image SKHelperStoreView passes ","            \/\/ its `ProductId` to this closure, which we can use to customize ","            \/\/ the displayed details","            Group {","                Image(productId + \".info\").resizable().scaledToFit()","                Text(\"Here is some text about why you might want to buy this product.\")","                Text(\"We think you'll find this product very useful!\")","            }","            .padding()","        }","    }","}"],"type":"codeListing"},{"type":"paragraph","inlineContent":[{"identifier":"guide22.png","type":"image"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"In a production app you would need to use theÂ "},{"code":"productId","type":"codeVoice"},{"text":"Â parameter passed to the closure to provide different details for each product. For example, you might create a string catalog which provides product details text. The key for each string in the catalog could be theÂ ","type":"text"},{"type":"codeVoice","code":"ProductId"},{"type":"text","text":"Â of the specific product."}]},{"level":3,"text":"How does SKHelperStoreView work?","anchor":"How-does-SKHelperStoreView-work","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"TODO - work in progress"}]}],"kind":"content"}],"references":{"guide17.png":{"type":"image","variants":[{"url":"\/images\/SKHelper\/guide17.png","traits":["1x","light"]}],"identifier":"guide17.png","alt":null},"guide4.png":{"type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide4.png"}],"identifier":"guide4.png","alt":null},"guide3.png":{"type":"image","variants":[{"url":"\/images\/SKHelper\/guide3.png","traits":["1x","light"]}],"identifier":"guide3.png","alt":null},"#Why-do-we-have-two-product-lists":{"title":"Why do we have two product lists?!","type":"link","url":"#Why-do-we-have-two-product-lists","identifier":"#Why-do-we-have-two-product-lists","titleInlineContent":[{"text":"Why do we have two product lists?!","type":"text"}]},"#The-StoreKit-Configuration-file":{"titleInlineContent":[{"type":"text","text":"The StoreKit Configuration file"}],"url":"#The-StoreKit-Configuration-file","title":"The StoreKit Configuration file","type":"link","identifier":"#The-StoreKit-Configuration-file"},"#The-SKHelperDemo-App":{"titleInlineContent":[{"text":"The SKHelperDemo App","type":"text"}],"url":"#The-SKHelperDemo-App","title":"The SKHelperDemo App","type":"link","identifier":"#The-SKHelperDemo-App"},"#Source-Code":{"titleInlineContent":[{"type":"text","text":"Source Code"}],"url":"#Source-Code","title":"Source Code","type":"link","identifier":"#Source-Code"},"doc://SKHelper/documentation/SKHelper":{"title":"SKHelper","abstract":[{"code":"SKHelper","type":"codeVoice"},{"type":"text","text":" is a Swift Package Manager (SPM) package that enables developers using "},{"inlineContent":[{"text":"Xcode 16","type":"text"}],"type":"strong"},{"text":" to easily add in-app purchase","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"support to "},{"type":"strong","inlineContent":[{"text":"iOS 17+","type":"text"}]},{"type":"text","text":" and "},{"type":"strong","inlineContent":[{"type":"text","text":"macOS 14.6+"}]},{"text":" SwiftUI apps.","type":"text"}],"identifier":"doc:\/\/SKHelper\/documentation\/SKHelper","type":"topic","images":[{"identifier":"skhelper-logo-small.png","type":"icon"}],"url":"\/documentation\/skhelper","kind":"symbol","role":"collection"},"https://developer.apple.com/documentation/storekit/in-app_purchase/supporting_promoted_in-app_purchases_in_your_app":{"titleInlineContent":[{"type":"text","text":"Supporting promoted In-App Purchases in your app | Apple Developer Documentation"}],"url":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/supporting_promoted_in-app_purchases_in_your_app","title":"Supporting promoted In-App Purchases in your app | Apple Developer Documentation","type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/supporting_promoted_in-app_purchases_in_your_app"},"#The-Products.plist-file":{"titleInlineContent":[{"text":"The Products.plist file","type":"text"}],"url":"#The-Products.plist-file","title":"The Products.plist file","type":"link","identifier":"#The-Products.plist-file"},"guide18.png":{"alt":null,"type":"image","identifier":"guide18.png","variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide18.png"}]},"#Prerequisites":{"titleInlineContent":[{"type":"text","text":"Prerequisites"}],"url":"#Prerequisites","title":"Prerequisites","type":"link","identifier":"#Prerequisites"},"#Do-I-really-need-SKHelper":{"titleInlineContent":[{"type":"text","text":"Do I really need SKHelper?"}],"url":"#Do-I-really-need-SKHelper","title":"Do I really need SKHelper?","type":"link","identifier":"#Do-I-really-need-SKHelper"},"quickstart1.png":{"alt":null,"type":"image","identifier":"quickstart1.png","variants":[{"url":"\/images\/SKHelper\/quickstart1.png","traits":["1x","light"]}]},"#Configuring-products":{"titleInlineContent":[{"text":"Configuring products","type":"text"}],"url":"#Configuring-products","title":"Configuring products","type":"link","identifier":"#Configuring-products"},"https://russell-archer.github.io/SKHelper/tutorials/quickstart":{"titleInlineContent":[{"type":"text","text":"SKHelper Quick Start"}],"url":"https:\/\/russell-archer.github.io\/SKHelper\/tutorials\/quickstart","title":"SKHelper Quick Start","type":"link","identifier":"https:\/\/russell-archer.github.io\/SKHelper\/tutorials\/quickstart"},"guide20.png":{"alt":null,"type":"image","identifier":"guide20.png","variants":[{"url":"\/images\/SKHelper\/guide20.png","traits":["1x","light"]}]},"guide21.png":{"alt":null,"type":"image","identifier":"guide21.png","variants":[{"url":"\/images\/SKHelper\/guide21.png","traits":["1x","light"]}]},"guide22.png":{"alt":null,"type":"image","identifier":"guide22.png","variants":[{"url":"\/images\/SKHelper\/guide22.png","traits":["1x","light"]}]},"#Configure-product-images":{"titleInlineContent":[{"text":"Configure product images","type":"text"}],"url":"#Configure-product-images","title":"Configure product images","type":"link","identifier":"#Configure-product-images"},"guide12.png":{"alt":null,"type":"image","identifier":"guide12.png","variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide12.png"}]},"guide19.png":{"alt":null,"type":"image","identifier":"guide19.png","variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide19.png"}]},"guide9.png":{"alt":null,"type":"image","identifier":"guide9.png","variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide9.png"}]},"#Localized-productâ€“information":{"title":"Localized product information","url":"#Localized-productâ€“information","type":"link","identifier":"#Localized-productâ€“information","titleInlineContent":[{"type":"text","text":"Localized product information"}]},"quickstart12.png":{"alt":null,"type":"image","identifier":"quickstart12.png","variants":[{"url":"\/images\/SKHelper\/quickstart12.png","traits":["1x","light"]}]},"guide11.png":{"alt":null,"type":"image","identifier":"guide11.png","variants":[{"url":"\/images\/SKHelper\/guide11.png","traits":["1x","light"]}]},"skhelper-logo-small.png":{"alt":null,"type":"image","identifier":"skhelper-logo-small.png","variants":[{"url":"\/images\/SKHelper\/skhelper-logo-small.png","traits":["1x","light"]}]},"guide2.png":{"alt":null,"type":"image","identifier":"guide2.png","variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide2.png"}]},"#What-is-StoreKit":{"title":"What is StoreKit?","url":"#What-is-StoreKit","type":"link","identifier":"#What-is-StoreKit","titleInlineContent":[{"type":"text","text":"What is StoreKit?"}]},"guide13.png":{"alt":null,"type":"image","identifier":"guide13.png","variants":[{"url":"\/images\/SKHelper\/guide13.png","traits":["1x","light"]}]},"#Displaying-a-list-of-products":{"title":"Displaying a list of products","url":"#Displaying-a-list-of-products","type":"link","identifier":"#Displaying-a-list-of-products","titleInlineContent":[{"text":"Displaying a list of products","type":"text"}]},"#What-is-SKHelper":{"title":"What is SKHelper?","url":"#What-is-SKHelper","type":"link","identifier":"#What-is-SKHelper","titleInlineContent":[{"type":"text","text":"What is SKHelper?"}]},"#Customizing-the-appearance-of-the-product-list":{"title":"Customizing the appearance of the product list","url":"#Customizing-the-appearance-of-the-product-list","type":"link","identifier":"#Customizing-the-appearance-of-the-product-list","titleInlineContent":[{"text":"Customizing the appearance of the product list","type":"text"}]},"guide15.png":{"alt":null,"type":"image","identifier":"guide15.png","variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide15.png"}]},"https://github.com/russell-archer/StoreHelper":{"title":"StoreHelper","url":"https:\/\/github.com\/russell-archer\/StoreHelper","type":"link","identifier":"https:\/\/github.com\/russell-archer\/StoreHelper","titleInlineContent":[{"type":"text","text":"StoreHelper"}]},"guide6.png":{"type":"image","variants":[{"url":"\/images\/SKHelper\/guide6.png","traits":["1x","light"]}],"identifier":"guide6.png","alt":null},"#References":{"title":"References","type":"link","url":"#References","identifier":"#References","titleInlineContent":[{"text":"References","type":"text"}]},"quickstart9.png":{"type":"image","variants":[{"url":"\/images\/SKHelper\/quickstart9.png","traits":["1x","light"]}],"identifier":"quickstart9.png","alt":null},"guide5.png":{"type":"image","variants":[{"url":"\/images\/SKHelper\/guide5.png","traits":["1x","light"]}],"identifier":"guide5.png","alt":null},"#What-are-we-building":{"title":"What are we building?","type":"link","url":"#What-are-we-building","identifier":"#What-are-we-building","titleInlineContent":[{"text":"What are we building?","type":"text"}]},"quickstart10.png":{"type":"image","alt":null,"identifier":"quickstart10.png","variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/quickstart10.png"}]},"quickstart2.png":{"alt":null,"type":"image","identifier":"quickstart2.png","variants":[{"url":"\/images\/SKHelper\/quickstart2.png","traits":["1x","light"]}]},"#Product-types":{"title":"Product types","titleInlineContent":[{"type":"text","text":"Product types"}],"url":"#Product-types","type":"link","identifier":"#Product-types"},"#How-does-SKHelperStoreView-work":{"title":"How does SKHelperStoreView work?","titleInlineContent":[{"type":"text","text":"How does SKHelperStoreView work?"}],"url":"#How-does-SKHelperStoreView-work","type":"link","identifier":"#How-does-SKHelperStoreView-work"},"guide16.png":{"alt":null,"type":"image","identifier":"guide16.png","variants":[{"url":"\/images\/SKHelper\/guide16.png","traits":["1x","light"]}]},"https://github.com/russell-archer/SKHelper":{"title":"GitHub","titleInlineContent":[{"type":"text","text":"GitHub"}],"url":"https:\/\/github.com\/russell-archer\/SKHelper","type":"link","identifier":"https:\/\/github.com\/russell-archer\/SKHelper"},"guide10.png":{"alt":null,"type":"image","identifier":"guide10.png","variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide10.png"}]},"guide7.png":{"alt":null,"type":"image","identifier":"guide7.png","variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide7.png"}]},"guide14.png":{"identifier":"guide14.png","alt":null,"variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide14.png"}],"type":"image"},"#Testing-non-U.S.-localizations":{"identifier":"#Testing-non-U.S.-localizations","titleInlineContent":[{"type":"text","text":"Testing non-U.S. localizations"}],"title":"Testing non-U.S. localizations","type":"link","url":"#Testing-non-U.S.-localizations"},"#What-does-this-document-provide":{"identifier":"#What-does-this-document-provide","titleInlineContent":[{"text":"What does this document provide?","type":"text"}],"type":"link","title":"What does this document provide?","url":"#What-does-this-document-provide"},"skhelper-logo.png":{"identifier":"skhelper-logo.png","alt":null,"variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/skhelper-logo.png"}],"type":"image"},"#Get-Started":{"identifier":"#Get-Started","titleInlineContent":[{"text":"Get Started","type":"text"}],"type":"link","title":"Get Started","url":"#Get-Started"},"#Enable-StoreKitâ€“Testing":{"identifier":"#Enable-StoreKitâ€“Testing","titleInlineContent":[{"type":"text","text":"Enable StoreKit Testing"}],"title":"Enable StoreKit Testing","type":"link","url":"#Enable-StoreKitâ€“Testing"},"guide1.png":{"alt":null,"identifier":"guide1.png","variants":[{"url":"\/images\/SKHelper\/guide1.png","traits":["1x","light"]}],"type":"image"},"https://github.com/russell-archer/SKHelperDemo":{"identifier":"https:\/\/github.com\/russell-archer\/SKHelperDemo","titleInlineContent":[{"type":"text","text":"SKHelper demo"}],"title":"SKHelper demo","type":"link","url":"https:\/\/github.com\/russell-archer\/SKHelperDemo"},"https://developer.apple.com/videos/play/wwdc2024/10061/":{"identifier":"https:\/\/developer.apple.com\/videos\/play\/wwdc2024\/10061\/","titleInlineContent":[{"text":"Whatâ€™s new in StoreKit and In-App Purchase - WWDC24 - Videos - Apple Developer","type":"text"}],"type":"link","title":"Whatâ€™s new in StoreKit and In-App Purchase - WWDC24 - Videos - Apple Developer","url":"https:\/\/developer.apple.com\/videos\/play\/wwdc2024\/10061\/"},"https://developer.apple.com/documentation/storekit":{"identifier":"https:\/\/developer.apple.com\/documentation\/storekit","titleInlineContent":[{"type":"text","text":"StoreKit | Apple Developer Documentation"}],"title":"StoreKit | Apple Developer Documentation","type":"link","url":"https:\/\/developer.apple.com\/documentation\/storekit"},"#Overview":{"identifier":"#Overview","titleInlineContent":[{"text":"Overview","type":"text"}],"type":"link","title":"Overview","url":"#Overview"},"quickstart4.png":{"type":"image","identifier":"quickstart4.png","variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/quickstart4.png"}],"alt":null},"guide8.png":{"type":"image","identifier":"guide8.png","variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide8.png"}],"alt":null}}}