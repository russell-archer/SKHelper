{"metadata":{"roleHeading":"Article","role":"article","title":"SKHelper Guide","images":[{"identifier":"skhelper-logo-small.png","type":"icon"}],"modules":[{"name":"SKHelper"}]},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/skhelper\/guide"]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"hierarchy":{"paths":[["doc:\/\/SKHelper\/documentation\/SKHelper"]]},"sections":[],"identifier":{"url":"doc:\/\/SKHelper\/documentation\/SKHelper\/guide","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"Updated: March 12, 2025"}],"primaryContentSections":[{"kind":"content","content":[{"anchor":"Contents","text":"Contents","level":2,"type":"heading"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"isActive":true,"identifier":"#Overview","type":"reference"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"isActive":true,"identifier":"#What-is-StoreKit","type":"reference"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"identifier":"#What-is-SKHelper","isActive":true,"type":"reference"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"#Source-Code","type":"reference","isActive":true}]}]},{"content":[{"inlineContent":[{"isActive":true,"identifier":"#References","type":"reference"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"#What-does-this-document-provide","isActive":true}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"identifier":"#Do-I-really-need-SKHelper","isActive":true,"type":"reference"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"#The-SKHelperDemo-App","isActive":true}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"#What-are-we-building","type":"reference","isActive":true}]}]},{"content":[{"inlineContent":[{"isActive":true,"type":"reference","identifier":"#Prerequisites"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"identifier":"#Get-Started","type":"reference","isActive":true}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"#Configuring-products","isActive":true}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"#Localized-product‚Äìinformation","isActive":true}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"isActive":true,"identifier":"#The-Products.plist-file","type":"reference"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"identifier":"#Product-types","type":"reference","isActive":true}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"#The-StoreKit-Configuration-file","isActive":true}]}]},{"content":[{"inlineContent":[{"identifier":"#Why-do-we-have-two-product-lists","isActive":true,"type":"reference"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"#Enable-StoreKit‚ÄìTesting","isActive":true}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"#Configure-product-images","isActive":true}]}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"#Displaying-a-list-of-products","isActive":true,"type":"reference"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"#Testing-non-U.S.-localizations","isActive":true}]}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"#Customizing-the-appearance-of-the-product-list","isActive":true}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"isActive":true,"identifier":"#Purchasing-products","type":"reference"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"isActive":true,"identifier":"#How-do-I-know-if-a-product-has-been-purchased","type":"reference"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"#Creating-your-own-purchase-button","isActive":true}]}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"#Transaction-Validation","isActive":true}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"#Restoring-Previous-Purchases","isActive":true}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"identifier":"#Ask-to-buy-Support","type":"reference","isActive":true}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"#Managing-Purchases","isActive":true}]}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"#Subscriptions","isActive":true}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"#Managing-Subscriptions","isActive":true}]}]},{"content":[{"type":"paragraph","inlineContent":[{"isActive":true,"identifier":"#Introductory-and-Promotional-Offers","type":"reference"}]}]},{"content":[{"inlineContent":[{"isActive":true,"identifier":"#Supporting-In-App-Promotional-Offer-Codes","type":"reference"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"identifier":"#Direct-App-Store-Purchases","type":"reference","isActive":true}],"type":"paragraph"}]}]},{"type":"thematicBreak"},{"anchor":"Overview","text":"Overview","level":2,"type":"heading"},{"inlineContent":[{"type":"text","text":"This guide describes how to implement and test in-app purchases with "},{"type":"strong","inlineContent":[{"text":"SwiftUI","type":"text"}]},{"type":"text","text":", "},{"type":"codeVoice","code":"SKHelper"},{"type":"text","text":", "},{"type":"codeVoice","code":"StoreKit2"},{"type":"text","text":", "},{"type":"strong","inlineContent":[{"type":"text","text":"Xcode 16, iOS 17+"}]},{"type":"text","text":"¬†and¬†"},{"type":"strong","inlineContent":[{"text":"macOS 14.6+","type":"text"}]},{"type":"text","text":"."}],"type":"paragraph"},{"inlineContent":[{"identifier":"skhelper-logo.png","type":"image"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"We will cover similar ground to that discussed in the "},{"type":"reference","isActive":true,"identifier":"https:\/\/russell-archer.github.io\/SKHelper\/tutorials\/quickstart"},{"type":"text","text":", although in much greater detail. No knowledge of "},{"type":"codeVoice","code":"StoreKit2"},{"type":"text","text":" or working with in-app purchases is assumed."}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"View the ","type":"text"},{"code":"SKHelper","type":"codeVoice"},{"text":" project on ","type":"text"},{"identifier":"https:\/\/github.com\/russell-archer\/SKHelper","isActive":true,"type":"reference"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"View the ","type":"text"},{"type":"reference","overridingTitleInlineContent":[{"type":"text","text":"Quick Start"}],"identifier":"https:\/\/russell-archer.github.io\/SKHelper\/tutorials\/quickstart","isActive":true,"overridingTitle":"Quick Start"},{"text":" on GitHub for an overview of how to get started","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"View the ","type":"text"},{"identifier":"https:\/\/github.com\/russell-archer\/SKHelperDemo","isActive":true,"type":"reference"},{"text":" project on GitHub","type":"text"}]}]}]},{"anchor":"What-is-StoreKit","text":"What is StoreKit?","level":2,"type":"heading"},{"inlineContent":[{"code":"StoreKit","type":"codeVoice"},{"type":"text","text":" is the Apple framework that provides API support for working the with the App Store to enable your app to offer in-app purchases and subscriptions. It‚Äôs important to distinguish between "},{"code":"StoreKit2","type":"codeVoice"},{"type":"text","text":" (introduced September 2021) and "},{"code":"StoreKit1","type":"codeVoice"},{"type":"text","text":", which was introduced in 2009 and  "},{"type":"strong","inlineContent":[{"text":"deprecated","type":"text"}]},{"type":"text","text":" when Xcode 16 was launched in September 2024. Apple sometimes refers to "},{"code":"StoreKit1","type":"codeVoice"},{"type":"text","text":" as the ‚Äúoriginal API for in-app purchase‚Äù."}],"type":"paragraph"},{"name":"Note","style":"note","type":"aside","content":[{"inlineContent":[{"type":"text","text":"üëâ In this document whenever we refer to "},{"code":"StoreKit","type":"codeVoice"},{"type":"text","text":" we mean "},{"code":"StoreKit2","type":"codeVoice"},{"type":"text","text":", the second major version of StoreKit."}],"type":"paragraph"}]},{"text":"What is SKHelper?","type":"heading","anchor":"What-is-SKHelper","level":2},{"inlineContent":[{"type":"codeVoice","code":"SKHelper"},{"type":"text","text":" is  a lightweight "},{"type":"codeVoice","code":"StoreKit"},{"type":"text","text":" "},{"type":"strong","inlineContent":[{"type":"text","text":"SwiftUI"}]},{"type":"text","text":" helper package that logically sits between your app and "},{"type":"codeVoice","code":"StoreKit"},{"type":"text","text":" to provide support for implementing in-app purchases and subscriptions in "},{"type":"strong","inlineContent":[{"text":"Xcode 16, iOS 17+","type":"text"}]},{"type":"text","text":"¬†and¬†"},{"type":"strong","inlineContent":[{"type":"text","text":"macOS 14.6+"}]},{"type":"text","text":". Note that support for¬†"},{"type":"strong","inlineContent":[{"text":"consumable","type":"text"}]},{"type":"text","text":"¬†transactions requires¬†"},{"type":"strong","inlineContent":[{"text":"iOS 18+","type":"text"}]},{"type":"text","text":"¬†and¬†"},{"type":"strong","inlineContent":[{"type":"text","text":"macOS 15+"}]},{"type":"text","text":"."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Designed to be an easier-to-use refactoring of my¬†"},{"isActive":true,"type":"reference","identifier":"https:\/\/github.com\/russell-archer\/StoreHelper"},{"type":"text","text":"¬†package, "},{"code":"SKHelper","type":"codeVoice"},{"type":"text","text":" makes use of Apple‚Äôs¬†"},{"type":"strong","inlineContent":[{"text":"StoreKit Views","type":"text"}]},{"type":"text","text":"¬†to provide a standard and easily customizable UI."}],"type":"paragraph"},{"inlineContent":[{"identifier":"guide1.png","type":"image"}],"type":"paragraph"},{"text":"Source Code","type":"heading","anchor":"Source-Code","level":2},{"inlineContent":[{"text":"The latest version of ","type":"text"},{"code":"SKHelper","type":"codeVoice"},{"text":" is always available ","type":"text"},{"identifier":"https:\/\/github.com\/russell-archer\/SKHelper","isActive":true,"overridingTitle":"on GitHub","overridingTitleInlineContent":[{"type":"text","text":"on GitHub"}],"type":"reference"},{"text":".","type":"text"}],"type":"paragraph"},{"style":"note","type":"aside","name":"Note","content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"The source code presented here and in the "},{"type":"codeVoice","code":"SKHelper"},{"type":"text","text":" package is for educational purposes."}]},{"type":"text","text":""},{"type":"text","text":" "},{"type":"strong","inlineContent":[{"text":"You may freely reuse and amend this code for use in your own apps. However, you do so entirely at your own risk.","type":"text"}]}],"type":"paragraph"}]},{"text":"References","type":"heading","anchor":"References","level":2},{"inlineContent":[{"isActive":true,"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/storekit"}],"type":"paragraph"},{"inlineContent":[{"isActive":true,"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/supporting_promoted_in-app_purchases_in_your_app"}],"type":"paragraph"},{"inlineContent":[{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/videos\/play\/wwdc2024\/10061\/"}],"type":"paragraph"},{"text":"What does this document provide?","type":"heading","anchor":"What-does-this-document-provide","level":2},{"inlineContent":[{"text":"This document discusses how to use Apple‚Äôs ","type":"text"},{"code":"StoreKit","type":"codeVoice"},{"text":" and the ","type":"text"},{"code":"SKHelper","type":"codeVoice"},{"text":" framework to provide in-app purchases in your ","type":"text"},{"inlineContent":[{"text":"iOS","type":"text"}],"type":"strong"},{"text":" or ","type":"text"},{"inlineContent":[{"type":"text","text":"macOS"}],"type":"strong"},{"text":" ","type":"text"},{"inlineContent":[{"type":"text","text":"SwiftUI"}],"type":"strong"},{"text":"-based apps. Specifically, we‚Äôll cover:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"How to use the ","type":"text"},{"code":"SKHelper","type":"codeVoice"},{"text":" package to create iOS and macOS SwiftUI apps that allows users to purchase a range of products:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Consumables"}],"type":"strong"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Non-consumables"}]}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Subscriptions"}],"type":"strong"}],"type":"paragraph"}]}],"type":"unorderedList"}]},{"content":[{"inlineContent":[{"text":"An in-depth review of how to use ","type":"text"},{"code":"SKHelper","type":"codeVoice"},{"text":", a Swift package that encapsulates ","type":"text"},{"code":"StoreKit","type":"codeVoice"},{"text":" in-app purchase functionality and makes it easy to work with the App Store","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Developing a demo app for an on-line florist that sells a range of flowers and other related services like home visits to water and care for house plants"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Requesting localized "},{"type":"strong","inlineContent":[{"type":"text","text":"product information"}]},{"type":"text","text":" from the App Store"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"How to "},{"inlineContent":[{"type":"text","text":"purchase"}],"type":"strong"},{"type":"text","text":" a product and "},{"inlineContent":[{"type":"text","text":"validate the transaction"}],"type":"strong"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Handling ","type":"text"},{"inlineContent":[{"type":"text","text":"pending (‚Äúask to buy‚Äù) transactions"}],"type":"strong"},{"text":" where parental permission must be obtained before a purchase is completed","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Handling ","type":"text"},{"inlineContent":[{"type":"text","text":"cancelled"}],"type":"strong"},{"text":" and ","type":"text"},{"inlineContent":[{"type":"text","text":"failed transactions"}],"type":"strong"}]}]},{"content":[{"inlineContent":[{"text":"Handling customer ","type":"text"},{"inlineContent":[{"type":"text","text":"refunds"}],"type":"strong"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Managing "},{"type":"strong","inlineContent":[{"type":"text","text":"subscriptions"}]},{"type":"text","text":", including upgrading, downgrading and cancelling"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Exploring detailed "},{"type":"strong","inlineContent":[{"text":"transaction information and history","type":"text"}]},{"type":"text","text":" for consumables, non-consumables and subscriptions"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Testing purchases locally using ","type":"text"},{"inlineContent":[{"type":"text","text":"StoreKit configuration"}],"type":"strong"},{"text":" files","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Support for direct App Store purchases of ","type":"text"},{"inlineContent":[{"text":"promoted in-app purchases","type":"text"}],"type":"strong"}],"type":"paragraph"}]}]},{"text":"Do I really need SKHelper?","type":"heading","anchor":"Do-I-really-need-SKHelper","level":2},{"inlineContent":[{"text":"No, you don‚Äôt. You can easily develop you own code to support in-app purchases, particularly now that ","type":"text"},{"code":"StoreKit","type":"codeVoice"},{"text":" provides SwiftUI views and view modifiers to enable user purchases. Prior to the introduction of ","type":"text"},{"code":"StoreKit2","type":"codeVoice"},{"text":", things were more complicated and there were three areas of particular difficulty:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Creating a purchase UI"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Validating purchases"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Working with delegate-based APIs."}]}]}]},{"inlineContent":[{"type":"codeVoice","code":"StoreKit2"},{"text":" addresses all these issues, and more:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"StoreKit Views"}],"type":"strong"},{"text":" enable the presentation of a standardized, customizable purchase UI","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Transactions are "},{"inlineContent":[{"text":"automatically","type":"text"}],"type":"strong"},{"type":"text","text":" validated against the App Store receipt"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"The ","type":"text"},{"code":"async","type":"codeVoice"},{"text":"\/","type":"text"},{"code":"await","type":"codeVoice"},{"text":" pattern is used throughout the API","type":"text"}]}]}],"type":"unorderedList"},{"inlineContent":[{"type":"text","text":"However, even if you develop your own in-app purchase code there are still a few areas of complexity, particularly with regard to subscriptions. You‚Äôll probably end up creating something very similar to "},{"type":"codeVoice","code":"SKHelper"},{"type":"text","text":"!"}],"type":"paragraph"},{"level":2,"anchor":"The-SKHelperDemo-App","type":"heading","text":"The SKHelperDemo App"},{"inlineContent":[{"type":"image","identifier":"guide2.png"}],"type":"paragraph"},{"inlineContent":[{"text":"The best way to get familiar with ","type":"text"},{"type":"codeVoice","code":"StoreKit"},{"text":" and ","type":"text"},{"type":"codeVoice","code":"SKHelper"},{"text":" is to create a simple, but full-featured (from an in-app purchase perspective) demo app. You may be surprised how little code is required to implement in-app purchases: ","type":"text"},{"type":"codeVoice","code":"SKHelper"},{"text":" and ","type":"text"},{"type":"codeVoice","code":"StoreKit"},{"text":" handle all the heavy-lifting!","type":"text"}],"type":"paragraph"},{"level":2,"anchor":"What-are-we-building","type":"heading","text":"What are we building?"},{"inlineContent":[{"text":"In this guide we‚Äôll be developing a demo app (","type":"text"},{"inlineContent":[{"text":"SKHelperDemo","type":"text"}],"type":"strong"},{"text":") for an on-line florist that sells a range of flowers and other related services like home visits to water and care for house plants. We‚Äôll develop the app for both macOS and iOS, using a single multi-platform Xcode project.","type":"text"}],"type":"paragraph"},{"level":2,"anchor":"Prerequisites","type":"heading","text":"Prerequisites"},{"inlineContent":[{"type":"text","text":"Before getting started you‚Äôll need to download "},{"inlineContent":[{"text":"Xcode 16","type":"text"}],"type":"strong"},{"type":"text","text":", along with the "},{"inlineContent":[{"text":"iOS 18 SDK and simulator","type":"text"}],"type":"strong"},{"type":"text","text":"."}],"type":"paragraph"},{"level":2,"anchor":"Get-Started","type":"heading","text":"Get Started"},{"inlineContent":[{"text":"To get started, create a new ","type":"text"},{"inlineContent":[{"type":"text","text":"multi-platform"}],"type":"strong"},{"text":" Xcode project and name it ","type":"text"},{"inlineContent":[{"type":"text","text":"SKHelperDemo:"}],"type":"strong"}],"type":"paragraph"},{"inlineContent":[{"type":"image","identifier":"quickstart1.png"}],"type":"paragraph"},{"inlineContent":[{"text":"Once Xcode has created the project select¬†","type":"text"},{"inlineContent":[{"text":"File > Add Package Dependencies","type":"text"}],"type":"strong"},{"text":":","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"image","identifier":"quickstart2.png"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"In the search field enter the URL of the¬†"},{"inlineContent":[{"type":"text","text":"SKHelper"}],"type":"strong"},{"type":"text","text":"¬†package on GitHub and tap¬†"},{"inlineContent":[{"type":"text","text":"Add Package:"}],"type":"strong"}],"type":"paragraph"},{"name":"Note","style":"note","content":[{"type":"paragraph","inlineContent":[{"text":"üëâ The URL of the¬†","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"SKHelper"}]},{"text":"¬†package is:¬†","type":"text"},{"overridingTitleInlineContent":[{"text":"https:\/\/github.com\/russell-archer\/SKHelper","type":"text"}],"identifier":"https:\/\/github.com\/russell-archer\/SKHelper","isActive":true,"type":"reference","overridingTitle":"https:\/\/github.com\/russell-archer\/SKHelper"}]}],"type":"aside"},{"inlineContent":[{"type":"image","identifier":"guide4.png"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Xcode will now retrieve the¬†"},{"type":"strong","inlineContent":[{"text":"SKHelper","type":"text"}]},{"type":"text","text":"¬†package from GitHub. When prompted, tap¬†"},{"type":"strong","inlineContent":[{"text":"Add Package","type":"text"}]},{"type":"text","text":"¬†to add the package to your project:"}]},{"type":"paragraph","inlineContent":[{"identifier":"quickstart4.png","type":"image"}]},{"type":"paragraph","inlineContent":[{"text":"We now need to add the necessary in-app purchase capabilities to our project. Select your project‚Äôs target and navigate to the¬†","type":"text"},{"inlineContent":[{"type":"text","text":"Signing & Capabilities"}],"type":"strong"},{"text":"¬†tab. Tap the¬†","type":"text"},{"inlineContent":[{"type":"text","text":"+ Capability"}],"type":"strong"},{"text":"¬†button and add the¬†","type":"text"},{"inlineContent":[{"text":"In-App Purchase","type":"text"}],"type":"strong"},{"text":"¬†capability to your project:","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide3.png"}]},{"level":2,"type":"heading","text":"Configuring products","anchor":"Configuring-products"},{"type":"paragraph","inlineContent":[{"text":"Before we do anything else we need to define the products we‚Äôll be selling. Ultimately, this will need to be done in¬†","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"App Store Connect"}]},{"text":". However, Xcode provides us with a local, on-device way of experimenting with in-app purchases.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"StoreKit Testing"}]},{"type":"text","text":", introduced in Xcode 12, is a test environment allows you to do early testing of in-app purchases in the simulator, without having to set anything up in App Store Connect. You define your products locally in a¬†"},{"type":"strong","inlineContent":[{"text":"StoreKit Configuration","type":"text"}]},{"type":"text","text":" file. Furthermore, you can view and delete transactions, issue refunds, cancel subscriptions, and a whole lot more. There‚Äôs also a new¬†"},{"type":"strong","inlineContent":[{"text":"StoreKitTest","type":"text"}]},{"type":"text","text":"¬†framework that enables you to do automated testing of IAPs."}]},{"level":2,"type":"heading","text":"Localized product information","anchor":"Localized-product-information"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Each product that we will sell in our app is identified by a unique "},{"type":"codeVoice","code":"ProductId"},{"type":"text","text":". You can either hard-code these ids into your app, or store them in an easily-modifiable property list file. In our demo app we‚Äôll use the property list approach."}]},{"type":"paragraph","inlineContent":[{"text":"When our demo app runs it will need to get¬†","type":"text"},{"inlineContent":[{"text":"localized","type":"text"}],"type":"emphasis"},{"text":"¬†product information. This includes things like a product‚Äôs name and description in the appropriate local language, and prices in the local currency. When an app has been released, or when using ","type":"text"},{"inlineContent":[{"text":"Sandbox testing","type":"text"}],"type":"strong"},{"text":" (more on this later) this information comes from the App Store. When using local Xcode StoreKit testing the information comes from the StoreKit Configuration file.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The switch between local StoreKit testing and the App Store is transparent in terms of our in-app purchase code: it‚Äôs a simple configuration change."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The following diagram shows the arrangement for requesting localized product information:"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide5.png"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"We create a list of product ids and provide them to "},{"type":"codeVoice","code":"SKHelper"},{"type":"text","text":" via a "},{"inlineContent":[{"type":"text","text":"Products.plist"}],"type":"strong"},{"type":"text","text":" file"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"The ","type":"text"},{"type":"codeVoice","code":"SKHelper.requestProducts()"},{"text":" method calls the","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"StoreKit "},{"code":"Product.products(for:)","type":"codeVoice"},{"type":"text","text":" method, passing the list of products ids"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"In production, a call is made to the App Store to get localized product info. If the project is configured to use StoreKit testing localized product information is returned from the "},{"code":"Products.storekit","type":"codeVoice"},{"type":"text","text":" configuration file"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"The resulting localized product information is stored in the ","type":"text"},{"code":"SKHelper.products","type":"codeVoice"},{"text":" property","type":"text"}]}]}],"type":"orderedList"},{"type":"heading","text":"The Products.plist file","anchor":"The-Productsplist-file","level":2},{"inlineContent":[{"type":"text","text":"Create a new¬†"},{"type":"strong","inlineContent":[{"type":"text","text":"Property List"}]},{"type":"text","text":"¬†file in your project and name it¬†"},{"type":"strong","inlineContent":[{"text":"Products.plist","type":"text"}]},{"type":"text","text":". Paste the contents of the example¬†"},{"type":"strong","inlineContent":[{"type":"text","text":"Products.plist"}]},{"type":"text","text":"¬†file shown into your¬†"},{"type":"strong","inlineContent":[{"type":"text","text":"Products.list"}]},{"type":"text","text":"¬†file."}],"type":"paragraph"},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"üëâ The "},{"type":"strong","inlineContent":[{"type":"text","text":"Products.plist"}]},{"type":"text","text":" file doesn‚Äôt "},{"type":"emphasis","inlineContent":[{"type":"text","text":"have"}]},{"type":"text","text":" to be named "},{"type":"strong","inlineContent":[{"type":"text","text":"Products.plist"}]},{"type":"text","text":", but by default "},{"code":"SKHelper","type":"codeVoice"},{"type":"text","text":" looks for a file of that name."}]}],"type":"aside","name":"Note","style":"note"},{"inlineContent":[{"text":"If you want to change it (and other configuration values) to something else you can create a custom configuration file in your project. See ","type":"text"},{"inlineContent":[{"text":"Configuration.plist","type":"text"}],"type":"strong"},{"text":" in the ","type":"text"},{"inlineContent":[{"type":"text","text":"SKHelper > Samples > Configuration"}],"type":"strong"},{"text":" folder for an example.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"You can tell ","type":"text"},{"code":"SKHelper","type":"codeVoice"},{"text":" to use the custom configuration to override default values when you initialize it:","type":"text"}],"type":"paragraph"},{"type":"codeListing","code":["\/\/ Use a custom configuration file named \"Configuration.plist\"","@State private var store = SKHelper(customConfiguration: \"Configuration\")"],"syntax":"swift"},{"inlineContent":[{"type":"text","text":"In the Xcode "},{"type":"strong","inlineContent":[{"type":"text","text":"Project navigator"}]},{"type":"text","text":" pane, right-click the property list you just created and select "},{"type":"strong","inlineContent":[{"text":"Open As > Source Code","type":"text"}]},{"type":"text","text":". Paste the following data into the file:"}],"type":"paragraph"},{"type":"codeListing","code":["<?xml version=\"1.0\" encoding=\"UTF-8\"?>","<!DOCTYPE plist PUBLIC \"-\/\/Apple\/\/DTD PLIST 1.0\/\/EN\" \"http:\/\/www.apple.com\/DTDs\/PropertyList-1.0.dtd\">","<plist version=\"1.0\">","<dict>","    <key>Products<\/key>","    <array>","        <string>com.rarcher.nonconsumable.flowers.large<\/string>","        <string>com.rarcher.nonconsumable.flowers.small<\/string>","        <string>com.rarcher.consumable.plant.installation<\/string>","    <\/array>","    <key>Subscriptions<\/key>","    <array>","        <dict>","            <key>Group<\/key>","            <string>vip<\/string>","            <key>Products<\/key>","            <array>","                <string>com.rarcher.subscription.vip.gold<\/string>","                <string>com.rarcher.subscription.vip.silver<\/string>","            <\/array>","        <\/dict>","    <\/array>","<\/dict>","<\/plist>"],"syntax":"xml"},{"content":[{"type":"paragraph","inlineContent":[{"text":"üëâ Make sure to include ","type":"text"},{"inlineContent":[{"type":"text","text":"Products.plist"}],"type":"strong"},{"text":" in the¬†","type":"text"},{"inlineContent":[{"text":"Target Membership","type":"text"}],"type":"strong"},{"text":"¬†for both the iOS and macOS targets. This is because we‚Äôll need the list of product ids in both testing and release builds.","type":"text"}]}],"type":"aside","name":"Note","style":"note"},{"inlineContent":[{"text":"Notice ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"consumable"}]},{"text":" and ","type":"text"},{"type":"strong","inlineContent":[{"text":"non-consumable","type":"text"}]},{"text":" (see below for definitions) products are listed in the ","type":"text"},{"type":"codeVoice","code":"Products"},{"text":" section, with ","type":"text"},{"type":"strong","inlineContent":[{"text":"subscriptions","type":"text"}]},{"text":" listed in the ","type":"text"},{"type":"codeVoice","code":"Subscriptions"},{"text":" section.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Also note that we‚Äôve adopted a "},{"type":"strong","inlineContent":[{"type":"text","text":"naming convention"}]},{"type":"text","text":" for our product ids:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"com.developer.product-type.name"}],"type":"emphasis"},{"text":" for consumables and non-consumables, and","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"com.developer.subscription.group.name"}],"type":"emphasis"},{"text":" for subscriptions","type":"text"}]}]}]},{"inlineContent":[{"text":"This isn‚Äôt strictly necessary, so product ids like ‚Äúlarge-flowers‚Äù and ‚Äúgold‚Äù are also perfectly acceptable as product ids only need to be unique within each particular app.","type":"text"}],"type":"paragraph"},{"type":"heading","text":"Product types","anchor":"Product-types","level":2},{"inlineContent":[{"text":"At this point we need to discuss product ","type":"text"},{"inlineContent":[{"text":"types","type":"text"}],"type":"emphasis"},{"text":". ","type":"text"},{"code":"SKHelper","type":"codeVoice"},{"text":" supports three types of product.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Consumables"}]}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"This type of product represents something that can be purchased and then ‚Äúused up‚Äù in some way. The user can purchase multiples of this type of product.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"For example, a consumable product might be an ‚Äúsuper-powers token‚Äù that grants the user extra abilities, for a limited time, in a game. In our demo we offer a consumable that represents an on-site visit to water and care for your plants. The product lasts for one visit and then expires. The user may purchase as many visits as they want.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Non-consumables","type":"text"}]}]},{"type":"paragraph","inlineContent":[{"text":"A non-consumable product is something the user purchases once and which lasts ‚Äúforever‚Äù. An example would be purchasing access to ‚Äúpro-level‚Äù functionality in a camera app. In our demo we sell non-consumable products like flowers and chocolates.","type":"text"}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Auto-renewable subscriptions","type":"text"}],"type":"strong"}]},{"type":"paragraph","inlineContent":[{"text":"An auto-renewable subscription represents a service that requires a regular payment. For example, a specialist skiing weather app might require a monthly subscription. The user may cancel the subscription at any time, in which case access to the service will end when the next renewal payment becomes due.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"Note that subscriptions are offered as part of a ","type":"text"},{"type":"strong","inlineContent":[{"text":"group","type":"text"}]},{"text":" of subscription products. For example, in the demo app we define a ‚ÄúVIP‚Äù subscription group (see Products.plist above) which contains two product ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"levels"}]},{"text":": ‚Äúgold‚Äù (the highest value) and ‚Äúsilver‚Äù. The position of the product id in the file determines the ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"product level"}]},{"text":" or ","type":"text"},{"type":"strong","inlineContent":[{"text":"value","type":"text"}]},{"text":". Products that appear towards the top of the file are of higher value than those defined towards the bottom of the file. We‚Äôll see later how easy it is to support users upgrading, downgrading or cancelling subscriptions.","type":"text"}]},{"style":"note","type":"aside","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"üëâ Note that SKHelper does not support the older type of "},{"inlineContent":[{"text":"non","type":"text"}],"type":"emphasis"},{"type":"text","text":"-renewable subscription, the use of which is discouraged by Apple."}]}],"name":"Note"},{"type":"heading","text":"The StoreKit Configuration file","level":2,"anchor":"The-StoreKit-Configuration-file"},{"type":"paragraph","inlineContent":[{"type":"text","text":"We can now create the StoreKit configuration file that will be used to provide localized product data during initial development and testing."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Create a¬†"},{"type":"strong","inlineContent":[{"text":"StoreKit Configuration File","type":"text"}]},{"type":"text","text":"¬†by selecting¬†"},{"type":"strong","inlineContent":[{"text":"File > New > File","type":"text"}]},{"type":"text","text":"¬†and choosing the¬†"},{"type":"strong","inlineContent":[{"text":"StoreKit Configuration File","type":"text"}]},{"type":"text","text":" template:"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"quickstart9.png"}]},{"type":"paragraph","inlineContent":[{"text":"From Xcode 14 onwards you can choose to create a¬†","type":"text"},{"inlineContent":[{"type":"text","text":"synced"}],"type":"strong"},{"text":"¬†","type":"text"},{"type":"codeVoice","code":".storekit"},{"text":"¬†configuration file that is linked to in-app purchases already defined in App Store Connect. Once you‚Äôve created the synced¬†","type":"text"},{"type":"codeVoice","code":".storekit"},{"text":"¬†configuration file you can‚Äôt edit it locally in Xcode, all changes have to be made in App Store Connect.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"After clicking¬†","type":"text"},{"type":"strong","inlineContent":[{"text":"Next","type":"text"}]},{"text":"¬†you‚Äôll be asked if you want to create a synced¬†","type":"text"},{"type":"codeVoice","code":".storekit"},{"text":"¬†configuration file:","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide6.png"}]},{"type":"paragraph","inlineContent":[{"text":"If you choose to sync your StoreKit configuration file with the App Store you‚Äôll be prompted to select one of your apps in App Store Connect:","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide7.png"}]},{"type":"paragraph","inlineContent":[{"text":"For the purposes of our demo we won‚Äôt create a synced configuration file.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"Open the newly created ","type":"text"},{"inlineContent":[{"text":"Products.storekit","type":"text"}],"type":"strong"},{"text":" file (you can name it anything you like) and click the ‚Äú+‚Äù at the bottom-left of the window. You‚Äôll be prompted to select the type of product you want to create:","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide8.png"}]},{"type":"paragraph","inlineContent":[{"text":"Create a ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"Consumable"}]},{"text":" in-app purchase and provide a ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"Reference Name"}]},{"text":" and ","type":"text"},{"type":"strong","inlineContent":[{"text":"Product ID","type":"text"}]},{"text":":","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide9.png"}]},{"type":"paragraph","inlineContent":[{"text":"The configuration file will open, allowing you to add pricing details and localization information:","type":"text"}]},{"type":"paragraph","inlineContent":[{"identifier":"guide10.png","type":"image"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"For now, just add a "},{"type":"strong","inlineContent":[{"text":"Display Name","type":"text"}]},{"type":"text","text":" and "},{"type":"strong","inlineContent":[{"type":"text","text":"Description"}]},{"type":"text","text":" for English (U.S.):"}]},{"type":"paragraph","inlineContent":[{"identifier":"guide11.png","type":"image"}]},{"type":"paragraph","inlineContent":[{"text":"Notice under the ","type":"text"},{"inlineContent":[{"type":"text","text":"APP"}],"type":"strong"},{"text":" section in the left pane you can configure various test settings and app policies:","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide12.png"}]},{"type":"paragraph","inlineContent":[{"text":"We‚Äôll come back to alter some of these settings later. For now, create two new non-consumable in-app purchases with the following details:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Reference Name: Flowers Large"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Product ID:","type":"text"},{"code":"com.rarcher.nonconsumable.flowers.large","type":"codeVoice"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Price (see note below): 1.99","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Display Name (English U.S.): Large Flowers"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description (English U.S.): A beautiful large bunch of seasonal flowers."}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Reference Name: Flowers Small"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Product ID:"},{"type":"codeVoice","code":"com.rarcher.nonconsumable.flowers.small"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Price (see note below): 0.99","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Display Name (English U.S.): Small Flowers"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description (English U.S.): A beautiful small bunch of seasonal flowers."}]}]}]},{"style":"note","type":"aside","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"üëâ These price values are a hard-coded test price for the product. Before deploying to the App Store, you‚Äôll configure real prices for your app‚Äôs in-app purchases and subscriptions in App Store Connect. In production your app will request localized price (and other) information from the App Store."}]}],"name":"Note"},{"style":"note","type":"aside","content":[{"type":"paragraph","inlineContent":[{"text":"üëâ Note also that none of the data defined in the local (non-synced)¬†","type":"text"},{"type":"codeVoice","code":".storekit"},{"text":"¬†file is ","type":"text"},{"type":"emphasis","inlineContent":[{"text":"ever","type":"text"}]},{"text":" uploaded to App Store Connect. It‚Äôs only used when testing in-app purchases locally in Xcode. No real user will ever see this test data.","type":"text"}]}],"name":"Note"},{"type":"paragraph","inlineContent":[{"text":"Your ","type":"text"},{"inlineContent":[{"text":"Products.storekit","type":"text"}],"type":"strong"},{"text":" configuration file should now look like this:","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide13.png"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Now we‚Äôll create our subscription products. Click the ‚Äú+‚Äù and select "},{"type":"strong","inlineContent":[{"type":"text","text":"Add Auto-Renewable Subscription"}]},{"type":"text","text":"."}]},{"type":"paragraph","inlineContent":[{"text":"You‚Äôll first be prompted to create a new subscription group. Name your group ‚Äú","type":"text"},{"inlineContent":[{"text":"vip‚Äù","type":"text"}],"type":"strong"},{"text":":","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide14.png"}]},{"type":"paragraph","inlineContent":[{"text":"Next, provide a ","type":"text"},{"inlineContent":[{"text":"Reference Name","type":"text"}],"type":"strong"},{"text":" of ‚Äú","type":"text"},{"inlineContent":[{"type":"text","text":"Silver‚Äù"}],"type":"strong"},{"text":" and ","type":"text"},{"inlineContent":[{"text":"Product ID","type":"text"}],"type":"strong"},{"text":" of ","type":"text"},{"code":"com.rarcher.subscription.vip.silver","type":"codeVoice"},{"text":":","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide15.png"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"You‚Äôll see that the StoreKit configuration file provides a range of offers and promotions. Ignore those for now and add the following details:"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Price: 29.99","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Display Name (English U.S.): Silver Service","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description (English U.S.): Personal care for your plants."}]}]}]},{"type":"paragraph","inlineContent":[{"text":"Now create a new ‚ÄúGold‚Äù subscription with the following details:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Reference Name: Gold"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Product ID: "},{"type":"codeVoice","code":"com.rarcher.subscription.vip.gold"}]}]},{"content":[{"inlineContent":[{"text":"Price: 39.99","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Display Name (English U.S.): Gold Service","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description (English U.S.): A touch of luxury for you plants."}]}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Finally, let‚Äôs create an introductory offer for the Gold product."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"In the "},{"inlineContent":[{"type":"text","text":"Introductory Offer"}],"type":"strong"},{"type":"text","text":" section, set the "},{"inlineContent":[{"type":"text","text":"Offer Type"}],"type":"strong"},{"type":"text","text":" to be "},{"inlineContent":[{"type":"text","text":"Free"}],"type":"strong"},{"type":"text","text":" and the "},{"inlineContent":[{"text":"Duration","type":"text"}],"type":"strong"},{"type":"text","text":" to be "},{"inlineContent":[{"text":"3 Days","type":"text"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"paragraph","inlineContent":[{"identifier":"guide16.png","type":"image"}]},{"type":"paragraph","inlineContent":[{"text":"If you now select the ‚Äúvip‚Äù group in the left pane you‚Äôll be able to configure settings for the group as a whole. Make sure that the ‚Äúgold‚Äù subscription (the most valuable) is at the top of the list by setting its ","type":"text"},{"type":"strong","inlineContent":[{"text":"Level value","type":"text"}]},{"text":" to ","type":"text"},{"type":"strong","inlineContent":[{"text":"1","type":"text"}]},{"text":". Also ensure that ‚Äúsilver‚Äù is set to level ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"2"}]},{"text":":","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide17.png"}]},{"type":"heading","anchor":"Why-do-we-have-two-product-lists","level":2,"text":"Why do we have two product lists?!"},{"type":"paragraph","inlineContent":[{"text":"At this point you may very reasonably be wondering why we have a ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"Products.storekit"}]},{"type":"text","text":" configuration file "},{"type":"emphasis","inlineContent":[{"type":"text","text":"and"}]},{"type":"text","text":" a "},{"type":"strong","inlineContent":[{"text":"Products.plist","type":"text"}]},{"type":"text","text":" file. Couldn‚Äôt we just make do with one, because data (product ids) is duplicated in the two files?"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"There is a fundamental principle in software development that may be summarized by the "},{"type":"strong","inlineContent":[{"type":"text","text":"DRY"}]},{"type":"text","text":" mnemonic: "},{"type":"strong","inlineContent":[{"type":"text","text":"D"}]},{"type":"text","text":"on‚Äôt "},{"type":"strong","inlineContent":[{"text":"R","type":"text"}]},{"type":"text","text":"epeat "},{"type":"strong","inlineContent":[{"type":"text","text":"Y"}]},{"type":"text","text":"ourself. Essentially, if you find you‚Äôve duplicated code or data you should generally find a way of abstracting it into a single entity, and then referencing that entity as required from multiple places. Experience shows that if you‚Äôve got basically the same thing scattered throughout your project, if you need to modify it there‚Äôs a good chance you‚Äôll forgot to update "},{"type":"emphasis","inlineContent":[{"text":"all","type":"text"}]},{"type":"text","text":" the occurrences. This can lead to difficult-to-find bugs and misery!"}]},{"type":"paragraph","inlineContent":[{"text":"So, because we‚Äôve defined our products in the StoreKit configuration file, it seems obvious that we should use ","type":"text"},{"inlineContent":[{"type":"text","text":"that"}],"type":"strong"},{"text":" as the repository for our product id data. Retrieving configuration data at runtime from the ","type":"text"},{"code":".storekit","type":"codeVoice"},{"text":" file isn‚Äôt difficult (it‚Äôs¬†","type":"text"},{"code":"JSON","type":"codeVoice"},{"text":"). However, the¬†","type":"text"},{"code":".storekit","type":"codeVoice"},{"text":" configuration file is intended for use¬†","type":"text"},{"inlineContent":[{"type":"text","text":"when testing"}],"type":"emphasis"},{"text":"¬†and it‚Äôs really ","type":"text"},{"inlineContent":[{"type":"text","text":"not"}],"type":"strong"},{"text":" a good idea to use it for production too. This is why the ","type":"text"},{"code":".storekit","type":"codeVoice"},{"text":" file is not included in any of your targets by default. It would be all too easy to allow ‚Äútest products‚Äù to somehow make it into the release build! So, in this case it‚Äôs better to violate the DRY principle, rather than risk something far worse!","type":"text"}]},{"type":"heading","anchor":"Enable-StoreKit-Testing","text":"Enable StoreKit Testing","level":2},{"type":"paragraph","inlineContent":[{"text":"Before moving on to other topics, we‚Äôll need to ","type":"text"},{"type":"emphasis","inlineContent":[{"text":"enable","type":"text"}]},{"text":" StoreKit testing in Xcode, as it‚Äôs disabled by default.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"Select¬†","type":"text"},{"type":"strong","inlineContent":[{"text":"Product > Scheme > Edit Scheme","type":"text"}]},{"text":". Now select¬†","type":"text"},{"type":"strong","inlineContent":[{"text":"Run","type":"text"}]},{"text":"¬†and the¬†","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"Options"}]},{"text":"¬†tab. You can now select the configuration file from the¬†","type":"text"},{"type":"strong","inlineContent":[{"text":"StoreKit Configuration","type":"text"}]},{"text":"¬†list:","type":"text"}]},{"type":"paragraph","inlineContent":[{"identifier":"quickstart12.png","type":"image"}]},{"level":2,"type":"heading","text":"Configure product images","anchor":"Configure-product-images"},{"type":"paragraph","inlineContent":[{"type":"text","text":"In the¬†"},{"type":"strong","inlineContent":[{"type":"text","text":"SKHelper"}]},{"type":"text","text":"¬†package, navigate to the¬†"},{"type":"strong","inlineContent":[{"type":"text","text":"Samples\/Images"}]},{"type":"text","text":"¬†folder. Select the images that have filenames that start with ‚Äúcom‚Äù then right-click them and select¬†"},{"type":"strong","inlineContent":[{"type":"text","text":"Show in Finder"}]},{"type":"text","text":"."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Locate the file named ‚Äúplant-services‚Äù and add that to your selection."}]},{"type":"paragraph","inlineContent":[{"text":"Drag all the selected images from Finder into your project‚Äôs asset catalog:","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"quickstart10.png"}]},{"type":"paragraph","inlineContent":[{"text":"Notice that each product has an image with a filename that corresponds to the product id.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"Switch back to Finder and use the files with names that start with ‚ÄúSKHelperDemo‚Äù to populate the asset catalog‚Äôs ","type":"text"},{"inlineContent":[{"text":"AppIcon","type":"text"}],"type":"strong"},{"text":" image set:","type":"text"}]},{"type":"paragraph","inlineContent":[{"identifier":"guide18.png","type":"image"}]},{"level":2,"type":"heading","text":"Displaying a list of products","anchor":"Displaying-a-list-of-products"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Having configured our products, let‚Äôs see how easy it is to display a list of them using "},{"type":"codeVoice","code":"SKHelper"},{"type":"text","text":"."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Open the project‚Äôs¬†"},{"type":"strong","inlineContent":[{"type":"text","text":"SKHelperDemoApp.swift"}]},{"type":"text","text":" file and replace the contents with the code as shown. Notice how we create an instance of the¬†"},{"type":"strong","inlineContent":[{"type":"text","text":"SKHelper"}]},{"type":"text","text":"¬†object and add it to the view environment:"}]},{"type":"codeListing","syntax":"swift","code":["import SwiftUI","import SKHelper","","@main","struct SKHelperDemoApp: App {","    @State private var store = SKHelper()","    ","    var body: some Scene {","        WindowGroup {","            ContentView()","                .environment(store)","        }","    }","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Now open "},{"inlineContent":[{"type":"text","text":"ContentView.swift"}],"type":"strong"},{"type":"text","text":"¬†file and replace the contents with the code shown:"}]},{"type":"codeListing","syntax":"swift","code":["import SwiftUI","import SKHelper","","struct ContentView: View {","    @Environment(SKHelper.self) private var store","    ","    var body: some View {","","        \/\/ SKHelperStoreView() lists all available products for this app.","        \/\/ Purchasing is supported. Purchased products will be grayed-out.","        \/\/ Tapping on a product's image shows details for that product.","        SKHelperStoreView()","    }","}"]},{"type":"paragraph","inlineContent":[{"code":"SKHelperStoreView()","type":"codeVoice"},{"text":"¬†uses a StoreKit¬†","type":"text"},{"code":"StoreView","type":"codeVoice"},{"text":"¬†(more on this later) to create a list of all our available products. When¬†","type":"text"},{"code":"SKHelper","type":"codeVoice"},{"text":"¬†is instantiated, it reads the¬†","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"Products.plist"}]},{"text":"¬†file we created previously and asks ","type":"text"},{"code":"StoreKit","type":"codeVoice"},{"text":" to fetch a collection of localized product information. This product information is stored in¬†","type":"text"},{"code":"SKHelper.products","type":"codeVoice"},{"text":".","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"If you now build and run the app you should see a list of all the products we configured earlier:"}]},{"type":"paragraph","inlineContent":[{"identifier":"guide19.png","type":"image"}]},{"type":"paragraph","inlineContent":[{"text":"Notice that:","type":"text"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Each product has a short text description, an image clipped to a circular shape and a price button"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"The list of products is sorted into groups by product type, with non-consumables shown first, then consumables, with subscriptions shown at the end of the list"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Tapping on the price button starts the standard purchase process for the product","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"There is a ‚ÄúRestore Missing Purchases‚Äù button, as required by the App Store","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Tapping on the product‚Äôs image shows a sheet containing product details:"}]}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide20.png"}]},{"level":2,"anchor":"Testing-non-US-localizations","text":"Testing non-U.S. localizations","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"When you run the app you‚Äôll see that prices are in US dollars. This is because, by default in the StoreKit test environment, the App Store¬†","type":"text"},{"inlineContent":[{"type":"text","text":"Storefront"}],"type":"strong"},{"text":"¬†is¬†","type":"text"},{"inlineContent":[{"text":"United States (USD)","type":"text"}],"type":"strong"},{"text":"¬†and the localization is¬†","type":"text"},{"inlineContent":[{"text":"English (US)","type":"text"}],"type":"strong"},{"text":". To support testing other locales you can change this.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"Make sure the¬†","type":"text"},{"code":"Products.storekit","type":"codeVoice"},{"text":"¬†file is open, then select¬†","type":"text"},{"inlineContent":[{"type":"text","text":"Editor > Default Storefront"}],"type":"strong"},{"text":"¬†and change this to another value. You can also changed the localization from¬†","type":"text"},{"inlineContent":[{"type":"text","text":"English (US"}],"type":"strong"},{"text":") with¬†","type":"text"},{"inlineContent":[{"text":"Editor > Default Localization","type":"text"}],"type":"strong"},{"text":". If you change the localization settings you‚Äôll need to make sure to add text matching that locale (e.g. French) to each product in the ","type":"text"},{"code":".storekit","type":"codeVoice"},{"text":" file:","type":"text"}]},{"type":"paragraph","inlineContent":[{"identifier":"guide21.png","type":"image"}]},{"level":2,"anchor":"Customizing-the-appearance-of-the-product-list","text":"Customizing the appearance of the product list","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"As you can see, you get so much functionality for just two lines of code! However, there are many ways in which you can customize how ","type":"text"},{"code":"SKHelperStoreView","type":"codeVoice"},{"text":" behaves. For example, we can modify the display of product details like this:","type":"text"}]},{"code":["struct ContentView: View {","    @Environment(SKHelper.self) private var store","    ","    var body: some View {","","        SKHelperStoreView() { productId in","            \/\/ When the user taps on the product's image SKHelperStoreView passes ","            \/\/ its `ProductId` to this closure, which we can use to customize ","            \/\/ the displayed details","            Group {","                Image(productId + \".info\").resizable().scaledToFit()","                Text(\"Here is some text about why you might want to buy this product.\")","                Text(\"We think you'll find this product very useful!\")","            }","            .padding()","        }","    }","}"],"type":"codeListing","syntax":"swift"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide22.png"}]},{"type":"paragraph","inlineContent":[{"text":"In a production app you would need to use the¬†","type":"text"},{"type":"codeVoice","code":"productId"},{"text":"¬†parameter passed to the closure to provide different details for each product. For example, you might create a string catalog which provides product details text. The key for each string in the catalog could be the¬†","type":"text"},{"type":"codeVoice","code":"ProductId"},{"text":"¬†of the specific product.","type":"text"}]},{"level":2,"anchor":"Purchasing-products","text":"Purchasing products","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"There are two main ways of purchasing products:","type":"text"}]},{"items":[{"content":[{"inlineContent":[{"text":"Use SKHelper ","type":"text"},{"type":"codeVoice","code":"SKHelperStoreView"},{"text":" or ","type":"text"},{"type":"codeVoice","code":"SKHelperSubscriptionStoreView"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Simple and easy","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Uses the standard purchase button UI and purchase flow provided by StoreKit "},{"type":"codeVoice","code":"StoreView"},{"type":"text","text":" and "},{"type":"codeVoice","code":"SubscriptionStoreView"}]}]}],"type":"unorderedList"}]},{"content":[{"inlineContent":[{"text":"Call SKHelper‚Äôs ","type":"text"},{"code":"purchase(_:options:)","type":"codeVoice"},{"text":" method","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"You provide your own purchase button and UI","type":"text"}]}]}],"type":"unorderedList"}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Here‚Äôs the code required for the easy-to-use option - it‚Äôs exactly as we used earlier for displaying the list of products:"}]},{"code":["import SwiftUI","import SKHelper","","struct ContentView: View {","    @Environment(SKHelper.self) private var store","    ","    var body: some View {","","        \/\/ SKHelperStoreView() lists all available products for this app.","        \/\/ Purchasing is supported. Purchased products will be grayed-out.","        \/\/ Tapping on a product's image shows details for that product.","        SKHelperStoreView()","    }","}"],"type":"codeListing","syntax":"swift"},{"type":"paragraph","inlineContent":[{"type":"text","text":"If you want more feedback on purchases you can add the optional "},{"type":"codeVoice","code":"onTransaction"},{"type":"text","text":" view modifier:"}]},{"code":["import SwiftUI","import SKHelper","","struct ContentView: View {","    @Environment(SKHelper.self) private var store","    ","    var body: some View {","        SKHelperStoreView()","            .onTransaction { productId, reason, transaction  in","                switch reason {","                    case .success:   print(\"Product \\(productId) successfully purchased\")","                    case .failure:   print(\"Purchase of \\(productId) failed\")","                    case .cancelled: print(\"Purchase of \\(productId) was cancelled by the user\")","                    case .revoked:   print(\"Access to the product \\(productId) was revoked by the App Store\")","                    case .upgraded:  print(\"Product \\(productId) was upgraed to a higher value product by the App Store\")","                    case .pending:   print(\"The purchase of \\(productId) is pending awaiting parental approval\")","                }","            }","    }","}"],"type":"codeListing","syntax":"swift"},{"level":2,"anchor":"How-do-I-know-if-a-product-has-been-purchased","text":"How do I know if a product has been purchased","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"A common scenario is to make the display of content dependent on a purchase. The following sample code shows how you can easily check the status of a purchase"},{"type":"text","text":" "},{"type":"text","text":"using the SKHelper "},{"code":"isPurchased(productId:)","type":"codeVoice"},{"type":"text","text":" method:"}]},{"code":["import SwiftUI","import SKHelper","","\/\/\/ This `SmallFlowersView` demonstrates how to check if the user has access to a ","\/\/\/ purchase-dependent resource. In this case, access to the \"small flowers\" resource ","\/\/\/ is only granted if the user has purchased the \"com.rarcher.nonconsumable.flowers.small\" ","\/\/\/ product.","\/\/\/","\/\/\/ Notice that we:","\/\/\/","\/\/\/ 1. Check the purchase before the View appears using: ","\/\/\/    .task { isPurchased = await store.isPurchased(productId: smallFlowersProductId) }","\/\/\/ ","\/\/\/ 2. If the user hasn't purchased the product we display a link to `SKHelperStoreView` and ","\/\/\/    pass the product id of the small flowers product. This causes `SKHelperStoreView` to display ","\/\/\/    only information about the small flowers product, rather than all available products ","\/\/\/    (the default)","\/\/\/","import SwiftUI","import SKHelper","","struct SmallFlowersView: View {","    @Environment(SKHelper.self) private var store","    @State private var isPurchased = false","    private let smallFlowersProductId = \"com.rarcher.nonconsumable.flowers.small\"","    ","    var body: some View {","        VStack {","            if isPurchased { FullAccess() }","            else { NoAccess() }","        }","        .task { isPurchased = await store.isPurchased(productId: smallFlowersProductId) }","    }","    ","    func FullAccess() -> some View {","        VStack {","            Text(\"You've purchased the small flowers - here they are, enjoy!\").padding()","            Image(smallFlowersProductId).resizable().scaledToFit()","        }","        .padding()","    }","    ","    func NoAccess() -> some View {","        VStack {","            Text(\"You haven't purchased the small flowers and don't have access.\").padding()","            ProductNavLink()","            Spacer()","        }","        .padding()","    }","    ","    func ProductNavLink() -> some View {","        NavigationLink(\"Review Small Flowers Info\") {","            SKHelperStoreView(productIds: [smallFlowersProductId]) { productId in","                Group {","                    Image(productId + \".info\").resizable().scaledToFit()","                    Text(\"Here is some text about why you might want to buy this product.\")","                }","                .padding()","            }","        }","    }","}",""],"type":"codeListing","syntax":"swift"},{"level":2,"anchor":"Creating-your-own-purchase-button","text":"Creating your own purchase button","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"If you don‚Äôt want to make use of "},{"type":"codeVoice","code":"SKHelperStoreView"},{"type":"text","text":" you can create your own purchase button and other purchase-related UI."},{"type":"text","text":" "},{"type":"text","text":"A simple example is shown below."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The steps required are as follows:"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Get the ","type":"text"},{"code":"SKHelperProduct","type":"codeVoice"},{"text":" for the product you want to purchase","type":"text"}]}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"SKHelperProduct"},{"type":"text","text":" encapsulates a StoreKit "},{"type":"codeVoice","code":"Product"},{"type":"text","text":", along with localized product information and a cached value for the user‚Äôs entitlement to use the product."},{"type":"text","text":" "},{"type":"text","text":"The easiest way to get the required product is to create an "},{"type":"codeVoice","code":"onProductsAvailable"},{"type":"text","text":" view modifier, which allows you to be notified when localized product information"},{"type":"text","text":" "},{"type":"text","text":"has been successfully retrieved from the App Store (SKHelper does this automatically when it‚Äôs initialized)."}]},{"items":[{"content":[{"inlineContent":[{"text":"Call SKHelper‚Äôs ","type":"text"},{"code":"purchase(_:options:)","type":"codeVoice"},{"text":" method","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Asynchronously call the SKHelper "},{"code":"purchase(_:options:)","type":"codeVoice"},{"type":"text","text":" method and await for the result. If "},{"code":"result.purchaseState == .purchased","type":"codeVoice"},{"type":"text","text":" then the purchase was a success."}]},{"code":["import SwiftUI","import SKHelper","","struct ContentView: View {","    @Environment(SKHelper.self) private var store","    @State private var product: SKHelperProduct?","    @State private var purchased = false","    private static var productId = \"com.rarcher.nonconsumable.flowers.small\"","    ","    var body: some View {","        VStack {","            if let product {","                Text(product.product.displayName).font(.headline)","                ","                \/\/ Display a button using the localized price","                Button(\"Purchase for only \\(product.product.displayPrice)\") {","                    Task {","                        let result = await store.purchase(product.product)  \/\/ Start the purchase flow for the product","                        if result.purchaseState == .purchased { purchased = true }","                    }","                }","                .tint(.blue)","                .padding()","                ","            } else { Text(\"Product not found\") }","            ","            if purchased { Text(\"Purchase success!\") }","            ","            Spacer()","            Button(\"Clear cached entitlements\") { store.clearCachedEntitlements() }.font(.caption).padding()","        }","        .onProductsAvailable { products  in","            \/\/ This view modifier is called when localized product information becomes available or updated","            product = products.first { product in product.id == ContentView.productId }  \/\/ Get the small flowers product","        }","    }","}"],"type":"codeListing","syntax":"swift"},{"level":2,"anchor":"Transaction-Validation","text":"Transaction Validation","type":"heading"},{"inlineContent":[{"type":"text","text":"When purchases are made an important part of StoreKit‚Äôs workflow is automatic "},{"type":"strong","inlineContent":[{"text":"validation","type":"text"}]},{"type":"text","text":" of the transaction. The validation process ensures that the user is entitled"},{"type":"text","text":" "},{"type":"text","text":"to use the product on that particular device. This involves examining the encrypted purchase receipt, which is issued by the App Store whenever a purchase is made or restored."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Prior to the introduction of StoreKit validation of receipts was a tricky business. The developer had four validation options: "},{"type":"strong","inlineContent":[{"type":"text","text":"server-side"}]},{"type":"text","text":" (required your own app server"},{"type":"text","text":" "},{"type":"text","text":"talking to Apple‚Äôs receipt validation server), "},{"type":"strong","inlineContent":[{"text":"on-device","type":"text"}]},{"type":"text","text":" (required a complex OpenSSL-based solution), "},{"type":"strong","inlineContent":[{"type":"text","text":"third-party"}]},{"type":"text","text":" (e.g. RevenueCat) or no receipt validation (trust"},{"type":"text","text":" "},{"type":"text","text":"the user)."}],"type":"paragraph"},{"inlineContent":[{"text":"Happily, we no longer have to deal with the details of this as StoreKit will validate transactions for us. To see how this works let‚Äôs review what happens when the user","type":"text"},{"text":" ","type":"text"},{"text":"makes a purchase via SKHelper‚Äôs ","type":"text"},{"code":"SKHelperStoreView","type":"codeVoice"},{"text":". Here‚Äôs a simplified snippet from ","type":"text"},{"code":"SKHelperStoreView","type":"codeVoice"},{"text":":","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["public struct SKHelperStoreView<Content: View>: View {    ","    @State private var hasProducts = false","    private var products: [Product]","    ","    public var body: some View {","        ","        if hasProducts {","            StoreView(products: products) { product in","            }","            .onInAppPurchaseCompletion { product, result in ","                await store.purchaseCompletion(for: product, with: try? result.get())","            }","            ","        } else {            ","            .onProductsAvailable { _  in","                \/\/ This view modifier is called when localized product information becomes available","                hasProducts = store.hasProducts","            }","        }","    }","}"]},{"inlineContent":[{"type":"text","text":"Notice how we make use of StoreKit‚Äôs "},{"type":"codeVoice","code":"StoreView()"},{"type":"text","text":" method to handle the display of purchase-related UI and process the actual payment. We then use StoreKit‚Äôs"},{"type":"text","text":" "},{"type":"codeVoice","code":"onInAppPurchaseCompletion"},{"type":"text","text":" modifier to be notified about the completion of the purchase process and call our "},{"type":"codeVoice","code":"purchaseCompletion(for:with:)"},{"type":"text","text":" method."}],"type":"paragraph"},{"inlineContent":[{"text":"SKHelper‚Äôs ","type":"text"},{"type":"codeVoice","code":"purchaseCompletion(for:with:)"},{"text":" method essentially has three jobs: check the result of StoreKit‚Äôs automatic validation, log the result and then","type":"text"},{"text":" ","type":"text"},{"text":"call the host app‚Äôs ","type":"text"},{"type":"codeVoice","code":"TransactionUpdateClosure"},{"text":" (if any) to inform them of the result of the purchase. The app can then decide whether or not to make the","type":"text"},{"text":" ","type":"text"},{"text":"product available to the user.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"Here‚Äôs a simplified snippet from ","type":"text"},{"type":"codeVoice","code":"purchaseCompletion(for:with:)"},{"text":":","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["internal func purchaseCompletion(for product: Product, with result: Product.PurchaseResult?) async -> (transaction: Transaction?, purchaseState: SKHelperPurchaseState) {","    :","    switch result {","        case .success(let verificationResult):","            let checkResult = checkVerificationResult(result: verificationResult)","            await validatedTransaction.finish()  \/\/ Tell the App Store we delivered the purchased content to the user","","            \/\/ Let the caller know the purchase succeeded and that the user should be given access to the product","            purchaseState = .purchased","            SKHelperLog.event(.purchaseSuccess, productId: product.id, transactionId: String(validatedTransaction.id))","            transactionUpdateListener?(product.id, .success, validatedTransaction)","            return (transaction: validatedTransaction, purchaseState: .purchased)","","        case .userCancelled:","            purchaseState = .cancelled","            SKHelperLog.event(.purchaseCancelled, productId: product.id)","            transactionUpdateListener?(product.id, .cancelled, nil)","            return (transaction: nil, .cancelled)","","        case .pending:","            purchaseState = .pending","            SKHelperLog.event(.purchasePending, productId: product.id)","            transactionUpdateListener?(product.id, .pending, nil)","            return (transaction: nil, .pending)","","        default:","            purchaseState = .unknown","            SKHelperLog.event(.purchaseFailure, productId: product.id)","            transactionUpdateListener?(product.id, .failure, nil)","            return (transaction: nil, .unknown)","    }","}",""]},{"inlineContent":[{"text":"We go through a similar validation process when we check if the user has purchased a product using SKHelper‚Äôs ","type":"text"},{"code":"isPurchased(productId:)","type":"codeVoice"},{"text":" method.","type":"text"},{"text":" ","type":"text"},{"text":"In this case we use StoreKit‚Äôs ","type":"text"},{"code":"Transaction.currentEntitlement(for: productId)","type":"codeVoice"},{"text":" to get the user‚Äôs entitlements for the particular product and then check","type":"text"},{"text":" ","type":"text"},{"text":"the automatic validation result. Here‚Äôs a simplified snippet:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["public func isPurchased(productId: ProductId) async -> Bool {","    var latestTransaction = await Transaction.currentEntitlement(for: productId) }","    if !latestTransaction { return false }  \/\/ No transaction means the user has not purchased the product","","    \/\/ Check the validation result to see if it's verified","    return checkVerificationResult(result: latestTransaction).verified  ","}"]},{"level":2,"type":"heading","text":"Restoring Previous Purchases","anchor":"Restoring-Previous-Purchases"},{"inlineContent":[{"type":"text","text":"Apples‚Äôs documentation states that apps must provide a mechanism to allow users to manually restore previous in-app purchases."}],"type":"paragraph"},{"style":"note","name":"Note","type":"aside","content":[{"inlineContent":[{"type":"text","text":"Failure to provide a ‚ÄúRestore‚Äù button will result in apps being rejected during the App Store review process."}],"type":"paragraph"}]},{"inlineContent":[{"text":"Apple states that manually (and programmatically) restoring previous purchases should no longer normally be necessary. However, you MUST still provide a manual","type":"text"},{"text":" ","type":"text"},{"text":"restore feature (see below) or your app will be rejected during the review process.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Programmatically restoring purchases simply requires an async call to "},{"type":"codeVoice","code":"AppStore.sync()"},{"type":"text","text":". However, it‚Äôs not a good idea to initiate a restore unless the user"},{"type":"text","text":" "},{"type":"text","text":"specifically requests it. This is because the user will immediately be prompted to authenticate with the App Store. This behaviour can be very disconcerting"},{"type":"text","text":" "},{"type":"text","text":"for the user, as it may not be obvious why they‚Äôre being asked for their credentials."}],"type":"paragraph"},{"inlineContent":[{"text":"By default, SKHelper‚Äôs ","type":"text"},{"code":"SKHelperStoreView","type":"codeVoice"},{"text":" uses the ","type":"text"},{"code":".storeButton","type":"codeVoice"},{"text":" view modifier with the ","type":"text"},{"code":".restorePurchases","type":"codeVoice"},{"text":" option to display a button that will restore","type":"text"},{"text":" ","type":"text"},{"text":"previous purchases:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["\/\/ SKHelperStoreView.swift",":","StoreView(products: products) { product in","    :","}",":","#if os(iOS)",".storeButton(.visible, for: .restorePurchases, .policies, .redeemCode)","#else"]},{"inlineContent":[{"text":"When ","type":"text"},{"type":"codeVoice","code":"SKHelperStoreView"},{"text":" is rendered it will display a ‚ÄúRestore Missing Purchases‚Äù button at the bottom of the available\/purchased products list.","type":"text"}],"type":"paragraph"},{"level":2,"type":"heading","text":"Ask-to-buy Support","anchor":"Ask-to-buy-Support"},{"inlineContent":[{"type":"text","text":"The App Store supports the concept of ‚Äúask-to-buy‚Äù purchases, where parents can configure an Apple ID to require their permission to make purchases."},{"type":"text","text":" "},{"type":"text","text":"When a user makes this type of purchase the "},{"code":"PurchaseResult","type":"codeVoice"},{"type":"text","text":" returned by StoreKit‚Äôs "},{"code":"product.purchase()","type":"codeVoice"},{"text":" method will have a value of ","type":"text"},{"code":".pending","type":"codeVoice"},{"text":".","type":"text"},{"text":" ","type":"text"},{"text":"This state can also be applicable when a user is required to make banking changes before a purchase is confirmed.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"With StoreKit testing we can easily simulate pending purchases to see if our app correctly supports them. To enable ask-to-buy support in StoreKit select","type":"text"},{"text":" ","type":"text"},{"text":"the .storekit configuration file and then select ","type":"text"},{"inlineContent":[{"type":"text","text":"Editor > Enable Ask To Buy"}],"type":"strong"},{"text":":","type":"text"}]},{"type":"paragraph","inlineContent":[{"identifier":"guide23.png","type":"image"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Now run the demo app and attempt to make a purchase. You‚Äôll find that the purchase proceeds as normal. However, instead of receiving a purchase confirmation"},{"type":"text","text":" "},{"type":"text","text":"you‚Äôll see an "},{"type":"strong","inlineContent":[{"type":"text","text":"Ask Permission"}]},{"type":"text","text":" alert:"}]},{"inlineContent":[{"type":"image","identifier":"guide24.png"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Tap "},{"type":"strong","inlineContent":[{"text":"Ask","type":"text"}]},{"type":"text","text":" and you‚Äôll see that the purchase enters a "},{"type":"codeVoice","code":".pending"},{"type":"text","text":" state, as shown in the console log:"}],"type":"paragraph"},{"inlineContent":[{"type":"codeVoice","code":"Purchase in progress. Awaiting authorization for product com.rarcher.nonconsumable.flowers.large"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"With the app still running, tap the "},{"type":"strong","inlineContent":[{"type":"text","text":"Manage StoreKit Transaction"}]},{"type":"text","text":" button in the Xcode debug area pane:"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"guide25.png"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"You‚Äôll now be able to see the transaction that is "},{"type":"strong","inlineContent":[{"type":"text","text":"Pending Approval"}]},{"type":"text","text":". Right-click the transaction that is pending approval and select "},{"type":"strong","inlineContent":[{"type":"text","text":"Approve Transaction"}]},{"type":"text","text":":"}]},{"type":"paragraph","inlineContent":[{"identifier":"guide26.png","type":"image"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"You should see the purchase confirmed in the console log as SKHelper processes the transaction:"}]},{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Transaction success for product com.rarcher.nonconsumable.flowers.large with transaction id 0"}]},{"type":"heading","level":2,"text":"Managing Purchases","anchor":"Managing-Purchases"},{"type":"paragraph","inlineContent":[{"type":"text","text":"info and refunds"}]},{"type":"heading","level":2,"text":"Subscriptions","anchor":"Subscriptions"},{"type":"heading","level":2,"text":"Managing Subscriptions","anchor":"Managing-Subscriptions"},{"type":"paragraph","inlineContent":[{"text":"info, refunds, upgrades, downgrades and cancellations","type":"text"}]},{"type":"heading","level":2,"text":"Introductory and Promotional Offers","anchor":"Introductory-and-Promotional-Offers"},{"type":"heading","level":2,"text":"Supporting In-App Promotional Offer Codes","anchor":"Supporting-In-App-Promotional-Offer-Codes"},{"type":"heading","level":2,"text":"Direct App Store Purchases","anchor":"Direct-App-Store-Purchases"}]}],"kind":"article","references":{"guide21.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide21.png"}],"identifier":"guide21.png","type":"image","alt":null},"#Why-do-we-have-two-product-lists":{"type":"link","title":"Why do we have two product lists?!","identifier":"#Why-do-we-have-two-product-lists","titleInlineContent":[{"type":"text","text":"Why do we have two product lists?!"}],"url":"#Why-do-we-have-two-product-lists"},"guide17.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide17.png"}],"type":"image","alt":null,"identifier":"guide17.png"},"#Ask-to-buy-Support":{"type":"link","title":"Ask-to-buy Support","identifier":"#Ask-to-buy-Support","titleInlineContent":[{"type":"text","text":"Ask-to-buy Support"}],"url":"#Ask-to-buy-Support"},"quickstart1.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/quickstart1.png"}],"type":"image","alt":null,"identifier":"quickstart1.png"},"guide16.png":{"variants":[{"url":"\/images\/SKHelper\/guide16.png","traits":["1x","light"]}],"type":"image","alt":null,"identifier":"guide16.png"},"#What-is-StoreKit":{"type":"link","title":"What is StoreKit?","identifier":"#What-is-StoreKit","titleInlineContent":[{"type":"text","text":"What is StoreKit?"}],"url":"#What-is-StoreKit"},"guide19.png":{"variants":[{"url":"\/images\/SKHelper\/guide19.png","traits":["1x","light"]}],"type":"image","alt":null,"identifier":"guide19.png"},"quickstart12.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/quickstart12.png"}],"type":"image","alt":null,"identifier":"quickstart12.png"},"guide3.png":{"variants":[{"url":"\/images\/SKHelper\/guide3.png","traits":["1x","light"]}],"type":"image","alt":null,"identifier":"guide3.png"},"#Managing-Subscriptions":{"type":"link","title":"Managing Subscriptions","identifier":"#Managing-Subscriptions","titleInlineContent":[{"type":"text","text":"Managing Subscriptions"}],"url":"#Managing-Subscriptions"},"https://developer.apple.com/documentation/storekit/in-app_purchase/supporting_promoted_in-app_purchases_in_your_app":{"type":"link","title":"Supporting promoted In-App Purchases in your app | Apple Developer Documentation","identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/supporting_promoted_in-app_purchases_in_your_app","titleInlineContent":[{"type":"text","text":"Supporting promoted In-App Purchases in your app | Apple Developer Documentation"}],"url":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/supporting_promoted_in-app_purchases_in_your_app"},"guide6.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide6.png"}],"type":"image","alt":null,"identifier":"guide6.png"},"#Overview":{"type":"link","title":"Overview","identifier":"#Overview","titleInlineContent":[{"type":"text","text":"Overview"}],"url":"#Overview"},"#The-StoreKit-Configuration-file":{"type":"link","title":"The StoreKit Configuration file","identifier":"#The-StoreKit-Configuration-file","titleInlineContent":[{"type":"text","text":"The StoreKit Configuration file"}],"url":"#The-StoreKit-Configuration-file"},"#References":{"type":"link","title":"References","identifier":"#References","titleInlineContent":[{"type":"text","text":"References"}],"url":"#References"},"quickstart4.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/quickstart4.png"}],"type":"image","alt":null,"identifier":"quickstart4.png"},"#How-do-I-know-if-a-product-has-been-purchased":{"type":"link","title":"How do I know if a product has been purchased","identifier":"#How-do-I-know-if-a-product-has-been-purchased","titleInlineContent":[{"type":"text","text":"How do I know if a product has been purchased"}],"url":"#How-do-I-know-if-a-product-has-been-purchased"},"#Do-I-really-need-SKHelper":{"type":"link","title":"Do I really need SKHelper?","identifier":"#Do-I-really-need-SKHelper","titleInlineContent":[{"type":"text","text":"Do I really need SKHelper?"}],"url":"#Do-I-really-need-SKHelper"},"#Displaying-a-list-of-products":{"type":"link","title":"Displaying a list of products","identifier":"#Displaying-a-list-of-products","titleInlineContent":[{"type":"text","text":"Displaying a list of products"}],"url":"#Displaying-a-list-of-products"},"guide22.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide22.png"}],"type":"image","alt":null,"identifier":"guide22.png"},"https://developer.apple.com/videos/play/wwdc2024/10061/":{"type":"link","title":"What‚Äôs new in StoreKit and In-App Purchase - WWDC24 - Videos - Apple Developer","identifier":"https:\/\/developer.apple.com\/videos\/play\/wwdc2024\/10061\/","titleInlineContent":[{"type":"text","text":"What‚Äôs new in StoreKit and In-App Purchase - WWDC24 - Videos - Apple Developer"}],"url":"https:\/\/developer.apple.com\/videos\/play\/wwdc2024\/10061\/"},"guide11.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide11.png"}],"type":"image","alt":null,"identifier":"guide11.png"},"guide8.png":{"variants":[{"url":"\/images\/SKHelper\/guide8.png","traits":["1x","light"]}],"type":"image","alt":null,"identifier":"guide8.png"},"#Creating-your-own-purchase-button":{"type":"link","title":"Creating your own purchase button","identifier":"#Creating-your-own-purchase-button","titleInlineContent":[{"type":"text","text":"Creating your own purchase button"}],"url":"#Creating-your-own-purchase-button"},"guide10.png":{"variants":[{"url":"\/images\/SKHelper\/guide10.png","traits":["1x","light"]}],"type":"image","alt":null,"identifier":"guide10.png"},"quickstart9.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/quickstart9.png"}],"type":"image","alt":null,"identifier":"quickstart9.png"},"#Get-Started":{"type":"link","title":"Get Started","identifier":"#Get-Started","titleInlineContent":[{"type":"text","text":"Get Started"}],"url":"#Get-Started"},"#What-are-we-building":{"type":"link","title":"What are we building?","identifier":"#What-are-we-building","titleInlineContent":[{"type":"text","text":"What are we building?"}],"url":"#What-are-we-building"},"https://developer.apple.com/documentation/storekit":{"type":"link","title":"StoreKit | Apple Developer Documentation","identifier":"https:\/\/developer.apple.com\/documentation\/storekit","titleInlineContent":[{"type":"text","text":"StoreKit | Apple Developer Documentation"}],"url":"https:\/\/developer.apple.com\/documentation\/storekit"},"guide20.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide20.png"}],"type":"image","alt":null,"identifier":"guide20.png"},"guide23.png":{"variants":[{"url":"\/images\/SKHelper\/guide23.png","traits":["1x","light"]}],"type":"image","alt":null,"identifier":"guide23.png"},"guide15.png":{"type":"image","identifier":"guide15.png","variants":[{"url":"\/images\/SKHelper\/guide15.png","traits":["1x","light"]}],"alt":null},"guide26.png":{"alt":null,"identifier":"guide26.png","variants":[{"url":"\/images\/SKHelper\/guide26.png","traits":["1x","light"]}],"type":"image"},"#Introductory-and-Promotional-Offers":{"type":"link","titleInlineContent":[{"text":"Introductory and Promotional Offers","type":"text"}],"title":"Introductory and Promotional Offers","url":"#Introductory-and-Promotional-Offers","identifier":"#Introductory-and-Promotional-Offers"},"https://github.com/russell-archer/SKHelper":{"titleInlineContent":[{"text":"GitHub","type":"text"}],"type":"link","identifier":"https:\/\/github.com\/russell-archer\/SKHelper","url":"https:\/\/github.com\/russell-archer\/SKHelper","title":"GitHub"},"#Prerequisites":{"type":"link","titleInlineContent":[{"text":"Prerequisites","type":"text"}],"title":"Prerequisites","url":"#Prerequisites","identifier":"#Prerequisites"},"#Supporting-In-App-Promotional-Offer-Codes":{"titleInlineContent":[{"text":"Supporting In-App Promotional Offer Codes","type":"text"}],"type":"link","identifier":"#Supporting-In-App-Promotional-Offer-Codes","url":"#Supporting-In-App-Promotional-Offer-Codes","title":"Supporting In-App Promotional Offer Codes"},"skhelper-logo.png":{"type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/skhelper-logo.png"}],"identifier":"skhelper-logo.png","alt":null},"guide4.png":{"type":"image","identifier":"guide4.png","alt":null,"variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide4.png"}]},"quickstart2.png":{"type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/quickstart2.png"}],"identifier":"quickstart2.png","alt":null},"#Localized-product‚Äìinformation":{"titleInlineContent":[{"text":"Localized product information","type":"text"}],"type":"link","identifier":"#Localized-product‚Äìinformation","url":"#Localized-product‚Äìinformation","title":"Localized product information"},"#The-Products.plist-file":{"titleInlineContent":[{"type":"text","text":"The Products.plist file"}],"type":"link","identifier":"#The-Products.plist-file","url":"#The-Products.plist-file","title":"The Products.plist file"},"guide2.png":{"type":"image","identifier":"guide2.png","alt":null,"variants":[{"traits":["1x","light"],"url":"\/images\/SKHelper\/guide2.png"}]},"#What-does-this-document-provide":{"type":"link","url":"#What-does-this-document-provide","identifier":"#What-does-this-document-provide","title":"What does this document provide?","titleInlineContent":[{"type":"text","text":"What does this document provide?"}]},"#Subscriptions":{"type":"link","identifier":"#Subscriptions","title":"Subscriptions","url":"#Subscriptions","titleInlineContent":[{"type":"text","text":"Subscriptions"}]},"guide7.png":{"type":"image","identifier":"guide7.png","alt":null,"variants":[{"url":"\/images\/SKHelper\/guide7.png","traits":["1x","light"]}]},"#Source-Code":{"title":"Source Code","titleInlineContent":[{"text":"Source Code","type":"text"}],"url":"#Source-Code","identifier":"#Source-Code","type":"link"},"guide14.png":{"type":"image","identifier":"guide14.png","variants":[{"url":"\/images\/SKHelper\/guide14.png","traits":["1x","light"]}],"alt":null},"#Customizing-the-appearance-of-the-product-list":{"title":"Customizing the appearance of the product list","titleInlineContent":[{"text":"Customizing the appearance of the product list","type":"text"}],"url":"#Customizing-the-appearance-of-the-product-list","identifier":"#Customizing-the-appearance-of-the-product-list","type":"link"},"guide5.png":{"type":"image","identifier":"guide5.png","variants":[{"url":"\/images\/SKHelper\/guide5.png","traits":["1x","light"]}],"alt":null},"guide18.png":{"alt":null,"identifier":"guide18.png","variants":[{"url":"\/images\/SKHelper\/guide18.png","traits":["1x","light"]}],"type":"image"},"https://github.com/russell-archer/StoreHelper":{"type":"link","identifier":"https:\/\/github.com\/russell-archer\/StoreHelper","url":"https:\/\/github.com\/russell-archer\/StoreHelper","titleInlineContent":[{"type":"text","text":"StoreHelper"}],"title":"StoreHelper"},"#What-is-SKHelper":{"titleInlineContent":[{"type":"text","text":"What is SKHelper?"}],"identifier":"#What-is-SKHelper","title":"What is SKHelper?","url":"#What-is-SKHelper","type":"link"},"#Configuring-products":{"type":"link","identifier":"#Configuring-products","url":"#Configuring-products","titleInlineContent":[{"type":"text","text":"Configuring products"}],"title":"Configuring products"},"guide24.png":{"alt":null,"identifier":"guide24.png","variants":[{"url":"\/images\/SKHelper\/guide24.png","traits":["1x","light"]}],"type":"image"},"#The-SKHelperDemo-App":{"type":"link","identifier":"#The-SKHelperDemo-App","url":"#The-SKHelperDemo-App","titleInlineContent":[{"type":"text","text":"The SKHelperDemo App"}],"title":"The SKHelperDemo App"},"#Managing-Purchases":{"titleInlineContent":[{"type":"text","text":"Managing Purchases"}],"identifier":"#Managing-Purchases","title":"Managing Purchases","url":"#Managing-Purchases","type":"link"},"guide9.png":{"type":"image","identifier":"guide9.png","variants":[{"url":"\/images\/SKHelper\/guide9.png","traits":["1x","light"]}],"alt":null},"quickstart10.png":{"alt":null,"identifier":"quickstart10.png","variants":[{"url":"\/images\/SKHelper\/quickstart10.png","traits":["1x","light"]}],"type":"image"},"guide13.png":{"type":"image","identifier":"guide13.png","variants":[{"url":"\/images\/SKHelper\/guide13.png","traits":["1x","light"]}],"alt":null},"#Transaction-Validation":{"titleInlineContent":[{"type":"text","text":"Transaction Validation"}],"identifier":"#Transaction-Validation","title":"Transaction Validation","url":"#Transaction-Validation","type":"link"},"https://russell-archer.github.io/SKHelper/tutorials/quickstart":{"type":"link","identifier":"https:\/\/russell-archer.github.io\/SKHelper\/tutorials\/quickstart","url":"https:\/\/russell-archer.github.io\/SKHelper\/tutorials\/quickstart","titleInlineContent":[{"type":"text","text":"SKHelper Quick Start"}],"title":"SKHelper Quick Start"},"skhelper-logo-small.png":{"alt":null,"identifier":"skhelper-logo-small.png","variants":[{"url":"\/images\/SKHelper\/skhelper-logo-small.png","traits":["1x","light"]}],"type":"image"},"#Purchasing-products":{"title":"Purchasing products","titleInlineContent":[{"type":"text","text":"Purchasing products"}],"url":"#Purchasing-products","identifier":"#Purchasing-products","type":"link"},"guide12.png":{"alt":null,"identifier":"guide12.png","variants":[{"url":"\/images\/SKHelper\/guide12.png","traits":["1x","light"]}],"type":"image"},"#Direct-App-Store-Purchases":{"title":"Direct App Store Purchases","titleInlineContent":[{"type":"text","text":"Direct App Store Purchases"}],"url":"#Direct-App-Store-Purchases","identifier":"#Direct-App-Store-Purchases","type":"link"},"#Testing-non-U.S.-localizations":{"titleInlineContent":[{"type":"text","text":"Testing non-U.S. localizations"}],"identifier":"#Testing-non-U.S.-localizations","title":"Testing non-U.S. localizations","url":"#Testing-non-U.S.-localizations","type":"link"},"#Configure-product-images":{"title":"Configure product images","titleInlineContent":[{"type":"text","text":"Configure product images"}],"url":"#Configure-product-images","identifier":"#Configure-product-images","type":"link"},"#Enable-StoreKit‚ÄìTesting":{"titleInlineContent":[{"type":"text","text":"Enable StoreKit Testing"}],"identifier":"#Enable-StoreKit‚ÄìTesting","title":"Enable StoreKit Testing","url":"#Enable-StoreKit‚ÄìTesting","type":"link"},"guide1.png":{"identifier":"guide1.png","type":"image","alt":null,"variants":[{"url":"\/images\/SKHelper\/guide1.png","traits":["1x","light"]}]},"guide25.png":{"alt":null,"identifier":"guide25.png","variants":[{"url":"\/images\/SKHelper\/guide25.png","traits":["1x","light"]}],"type":"image"},"doc://SKHelper/documentation/SKHelper":{"identifier":"doc:\/\/SKHelper\/documentation\/SKHelper","images":[{"type":"icon","identifier":"skhelper-logo-small.png"}],"title":"SKHelper","type":"topic","role":"collection","kind":"symbol","url":"\/documentation\/skhelper","abstract":[{"type":"codeVoice","code":"SKHelper"},{"type":"text","text":" is a Swift Package Manager (SPM) package that enables developers using "},{"type":"strong","inlineContent":[{"type":"text","text":"Xcode 16"}]},{"type":"text","text":" to easily add in-app purchase"},{"type":"text","text":" "},{"type":"text","text":"support to "},{"type":"strong","inlineContent":[{"text":"iOS 17+","type":"text"}]},{"type":"text","text":" and "},{"type":"strong","inlineContent":[{"text":"macOS 14.6+","type":"text"}]},{"type":"text","text":" SwiftUI apps."}]},"#Product-types":{"title":"Product types","titleInlineContent":[{"type":"text","text":"Product types"}],"url":"#Product-types","identifier":"#Product-types","type":"link"},"#Restoring-Previous-Purchases":{"titleInlineContent":[{"text":"Restoring Previous Purchases","type":"text"}],"identifier":"#Restoring-Previous-Purchases","title":"Restoring Previous Purchases","url":"#Restoring-Previous-Purchases","type":"link"},"https://github.com/russell-archer/SKHelperDemo":{"url":"https:\/\/github.com\/russell-archer\/SKHelperDemo","identifier":"https:\/\/github.com\/russell-archer\/SKHelperDemo","type":"link","title":"SKHelper demo","titleInlineContent":[{"text":"SKHelper demo","type":"text"}]}}}